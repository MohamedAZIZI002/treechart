!function(e,R){"object"==typeof exports&&"object"==typeof module?module.exports=R():"function"==typeof define&&define.amd?define("dscc",[],R):"object"==typeof exports?exports.dscc=R():e.dscc=R()}(window,function(){return t={},n.m=C={"./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/*! no static exports found */function(e,N,R){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var R,C=1,t=arguments.length;C<t;C++)for(var n in R=arguments[C])Object.prototype.hasOwnProperty.call(R,n)&&(e[n]=R[n]);return e}).apply(this,arguments)};Object.defineProperty(N,"__esModule",{value:!0});
/*!
  @license
  Copyright 2019 Google LLC

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
*/
var _=R(/*! ./types */"./src/types.ts");!function(e){for(var R in e)N.hasOwnProperty(R)||(N[R]=e[R])}(R(/*! ./types */"./src/types.ts")),N.getWidth=function(){return document.body.clientWidth},N.getHeight=function(){return document.documentElement.clientHeight},N.getComponentId=function(){var e=new URLSearchParams(window.location.search);if(null!==e.get("dscId"))return e.get("dscId");throw new Error("dscId must be in the query parameters. This is a bug in ds-component, please file a bug: https://github.com/googledatastudio/ds-component/issues/new")};function E(e){return e.type===_.ConfigDataElementType.DIMENSION||e.type===_.ConfigDataElementType.METRIC}function r(e){return e===_.ConfigDataElementType.DIMENSION?-1:1}function a(e){var R=[];e.config.data.forEach(function(e){e.elements.filter(E).forEach(function(e){R.push(e)})});var C,t=(C=function(e,R){return r(e.type)-r(R.type)},R.map(function(e,R){return{item:e,index:R}}).sort(function(e,R){return C(e.item,R.item)||e.index-R.index}).map(function(e){return e.item})),n=[];return t.forEach(function(e){e.value.forEach(function(){return n.push(e.id)})}),n}function o(R){return function(e){var C,t,n={};return t=R,((C=e).length<t.length?C.map(function(e,R){return[e,t[R]]}):t.map(function(e,R){return[C[R],e]})).forEach(function(e){var R=e[0],C=e[1];void 0===n[C]&&(n[C]=[]),n[C].push(R)},{}),n}}N.fieldsByConfigId=function(e){var R=e.fields.reduce(function(e,R){return e[R.id]=R,e},{}),C={};return e.config.data.forEach(function(e){e.elements.filter(E).forEach(function(e){C[e.id]=e.value.map(function(e){return R[e]})})}),C};function U(e){var R={};return(e.config.style||[]).forEach(function(e){e.elements.forEach(function(e){if(void 0!==R[e.id])throw new Error("styleIds must be unique. Your styleId: '"+e.id+"' is used more than once.");R[e.id]={value:e.value,defaultValue:e.defaultValue}})},{}),R}function Y(e){return e.config.themeStyle}function n(e){switch(e){case _.DSInteractionType.FILTER:return _.InteractionType.FILTER}}function s(e){var R=e.config.interactions;return void 0===R?{}:R.reduce(function(e,R){var C=R.supportedActions.map(n),t={type:n(R.value.type),data:R.value.data};return e[R.id]={value:t,supportedActions:C},e},{})}N.tableTransform=function(e){return{tables:(R=e,t=N.fieldsByConfigId(R),n=a(R),E={},r=n.map(function(e){void 0===E[e]?E[e]=0:E[e]++;var R=E[e],C=t[e][R];return i(i({},C),{configId:e})}),(C={})[_.TableType.DEFAULT]={headers:[],rows:[]},o=C,R.dataResponse.tables.forEach(function(e){o[e.id]={headers:r,rows:e.rows}}),o),fields:N.fieldsByConfigId(e),style:U(e),theme:Y(e),interactions:s(e)};var R,C,t,n,E,r,o},N.objectTransform=function(e){return{tables:(t=a(R=e),(C={})[_.TableType.DEFAULT]=[],n=C,R.dataResponse.tables.forEach(function(e){var R=e.rows.map(o(t));e.id===_.TableType.DEFAULT?n[e.id]=R:(void 0===n[e.id]&&(n[e.id]=[]),n[e.id]=n[e.id].concat(R))}),n),fields:N.fieldsByConfigId(e),style:U(e),theme:Y(e),interactions:s(e)};var R,C,t,n};function u(e){var R,C=!1;return e===N.tableTransform||e===N.objectTransform?C=!0:(R=!1,"identity"===e("identity")&&(R=!0,console.warn("This is an unsupported data format. Please use one of the supported transforms:\n       dscc.objectFormat or dscc.tableFormat.")),R&&(C=!0)),C}N.subscribeToData=function(R,C){if(u(C.transform)){var e=function(e){e.data.type===_.MessageType.RENDER?R(C.transform(e.data)):console.error("MessageType: "+e.data.type+" is not supported by this version of the library.")};window.addEventListener("message",e);var t={componentId:N.getComponentId(),type:_.ToDSMessageType.VIZ_READY};return window.parent.postMessage(t,"*"),function(){return window.removeEventListener("message",e)}}throw new Error("Only the built in transform functions are supported.")},N.sendInteraction=function(e,R,C){var t=N.getComponentId(),n={type:_.ToDSMessageType.INTERACTION,id:e,data:C,componentId:t};window.parent.postMessage(n,"*")},N.clearInteraction=function(e,R){N.sendInteraction(e,R,void 0)}},"./src/types.ts":
/*!**********************!*\
  !*** ./src/types.ts ***!
  \**********************/
/*! no static exports found */function(e,R,C){"use strict";var t,n,E,r,o,N;Object.defineProperty(R,"__esModule",{value:!0}),(t=R.ConceptType||(R.ConceptType={})).METRIC="METRIC",t.DIMENSION="DIMENSION",(R.MessageType||(R.MessageType={})).RENDER="RENDER",(n=R.FieldType||(R.FieldType={})).YEAR="YEAR",n.YEAR_QUARTER="YEAR_QUARTER",n.YEAR_MONTH="YEAR_MONTH",n.YEAR_WEEK="YEAR_WEEK",n.YEAR_MONTH_DAY="YEAR_MONTH_DAY",n.YEAR_MONTH_DAY_HOUR="YEAR_MONTH_DAY_HOUR",n.QUARTER="QUARTER",n.MONTH="MONTH",n.WEEK="WEEK",n.MONTH_DAY="MONTH_DAY",n.DAY_OF_WEEK="DAY_OF_WEEK",n.DAY="DAY",n.HOUR="HOUR",n.MINUTE="MINUTE",n.DURATION="DURATION",n.COUNTRY="COUNTRY",n.COUNTRY_CODE="COUNTRY_CODE",n.CONTINENT="CONTINENT",n.CONTINENT_CODE="CONTINENT_CODE",n.SUB_CONTINENT="SUB_CONTINENT",n.SUB_CONTINENT_CODE="SUB_CONTINENT_CODE",n.REGION="REGION",n.REGION_CODE="REGION_CODE",n.CITY="CITY",n.CITY_CODE="CITY_CODE",n.METRO_CODE="METRO_CODE",n.LATITUDE_LONGITUDE="LATITUDE_LONGITUDE",n.NUMBER="NUMBER",n.PERCENT="PERCENT",n.TEXT="TEXT",n.BOOLEAN="BOOLEAN",n.URL="URL",n.IMAGE="IMAGE",n.CURRENCY_AED="CURRENCY_AED",n.CURRENCY_ALL="CURRENCY_ALL",n.CURRENCY_ARS="CURRENCY_ARS",n.CURRENCY_AUD="CURRENCY_AUD",n.CURRENCY_BDT="CURRENCY_BDT",n.CURRENCY_BGN="CURRENCY_BGN",n.CURRENCY_BOB="CURRENCY_BOB",n.CURRENCY_BRL="CURRENCY_BRL",n.CURRENCY_CAD="CURRENCY_CAD",n.CURRENCY_CDF="CURRENCY_CDF",n.CURRENCY_CHF="CURRENCY_CHF",n.CURRENCY_CLP="CURRENCY_CLP",n.CURRENCY_CNY="CURRENCY_CNY",n.CURRENCY_COP="CURRENCY_COP",n.CURRENCY_CRC="CURRENCY_CRC",n.CURRENCY_CZK="CURRENCY_CZK",n.CURRENCY_DKK="CURRENCY_DKK",n.CURRENCY_DOP="CURRENCY_DOP",n.CURRENCY_EGP="CURRENCY_EGP",n.CURRENCY_ETB="CURRENCY_ETB",n.CURRENCY_EUR="CURRENCY_EUR",n.CURRENCY_GBP="CURRENCY_GBP",n.CURRENCY_HKD="CURRENCY_HKD",n.CURRENCY_HRK="CURRENCY_HRK",n.CURRENCY_HUF="CURRENCY_HUF",n.CURRENCY_IDR="CURRENCY_IDR",n.CURRENCY_ILS="CURRENCY_ILS",n.CURRENCY_INR="CURRENCY_INR",n.CURRENCY_IRR="CURRENCY_IRR",n.CURRENCY_ISK="CURRENCY_ISK",n.CURRENCY_JMD="CURRENCY_JMD",n.CURRENCY_JPY="CURRENCY_JPY",n.CURRENCY_KRW="CURRENCY_KRW",n.CURRENCY_LKR="CURRENCY_LKR",n.CURRENCY_LTL="CURRENCY_LTL",n.CURRENCY_MNT="CURRENCY_MNT",n.CURRENCY_MVR="CURRENCY_MVR",n.CURRENCY_MXN="CURRENCY_MXN",n.CURRENCY_MYR="CURRENCY_MYR",n.CURRENCY_NOK="CURRENCY_NOK",n.CURRENCY_NZD="CURRENCY_NZD",n.CURRENCY_PAB="CURRENCY_PAB",n.CURRENCY_PEN="CURRENCY_PEN",n.CURRENCY_PHP="CURRENCY_PHP",n.CURRENCY_PKR="CURRENCY_PKR",n.CURRENCY_PLN="CURRENCY_PLN",n.CURRENCY_RON="CURRENCY_RON",n.CURRENCY_RSD="CURRENCY_RSD",n.CURRENCY_RUB="CURRENCY_RUB",n.CURRENCY_SAR="CURRENCY_SAR",n.CURRENCY_SEK="CURRENCY_SEK",n.CURRENCY_SGD="CURRENCY_SGD",n.CURRENCY_THB="CURRENCY_THB",n.CURRENCY_TRY="CURRENCY_TRY",n.CURRENCY_TWD="CURRENCY_TWD",n.CURRENCY_TZS="CURRENCY_TZS",n.CURRENCY_UAH="CURRENCY_UAH",n.CURRENCY_USD="CURRENCY_USD",n.CURRENCY_UYU="CURRENCY_UYU",n.CURRENCY_VEF="CURRENCY_VEF",n.CURRENCY_VND="CURRENCY_VND",n.CURRENCY_YER="CURRENCY_YER",n.CURRENCY_ZAR="CURRENCY_ZAR",(E=R.TableType||(R.TableType={})).DEFAULT="DEFAULT",E.COMPARISON="COMPARISON",E.SUMMARY="SUMMARY",(r=R.ConfigDataElementType||(R.ConfigDataElementType={})).METRIC="METRIC",r.DIMENSION="DIMENSION",r.MAX_RESULTS="MAX_RESULTS",(o=R.ConfigStyleElementType||(R.ConfigStyleElementType={})).TEXTINPUT="TEXTINPUT",o.SELECT_SINGLE="SELECT_SINGLE",o.CHECKBOX="CHECKBOX",o.FONT_COLOR="FONT_COLOR",o.FONT_SIZE="FONT_SIZE",o.FONT_FAMILY="FONT_FAMILY",o.FILL_COLOR="FILL_COLOR",o.BORDER_COLOR="BORDER_COLOR",o.AXIS_COLOR="AXIS_COLOR",o.GRID_COLOR="GRID_COLOR",o.OPACITY="OPACITY",o.LINE_WEIGHT="LINE_WEIGHT",o.LINE_STYLE="LINE_STYLE",o.BORDER_RADIUS="BORDER_RADIUS",o.INTERVAL="INTERVAL",o.SELECT_RADIO="SELECT_RADIO",(R.DSInteractionType||(R.DSInteractionType={})).FILTER="FILTER",(N=R.ToDSMessageType||(R.ToDSMessageType={})).VIZ_READY="vizReady",N.INTERACTION="vizAction",(R.InteractionType||(R.InteractionType={})).FILTER="FILTER"}},n.c=t,n.d=function(e,R,C){n.o(e,R)||Object.defineProperty(e,R,{enumerable:!0,get:C})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(R,e){if(1&e&&(R=n(R)),8&e)return R;if(4&e&&"object"==typeof R&&R&&R.__esModule)return R;var C=Object.create(null);if(n.r(C),Object.defineProperty(C,"default",{enumerable:!0,value:R}),2&e&&"string"!=typeof R)for(var t in R)n.d(C,t,function(e){return R[e]}.bind(null,t));return C},n.n=function(e){var R=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(R,"a",R),R},n.o=function(e,R){return Object.prototype.hasOwnProperty.call(e,R)},n.p="",n(n.s="./src/index.ts");function n(e){if(t[e])return t[e].exports;var R=t[e]={i:e,l:!1,exports:{}};return C[e].call(R.exports,R,R.exports,n),R.l=!0,R.exports}var C,t});
;
(()=>{var ei={value:()=>{}};function qe(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new gt(r)}function gt(t){this._=t}function ri(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}gt.prototype=qe.prototype={constructor:gt,on:function(t,e){var r=this._,n=ri(t+"",r),i,o=-1,a=n.length;if(arguments.length<2){for(;++o<a;)if((i=(t=n[o]).type)&&(i=ni(r[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(i=(t=n[o]).type)r[i]=Le(r[i],t.name,e);else if(e==null)for(i in r)r[i]=Le(r[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new gt(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,o;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],n=0,i=o.length;n<i;++n)o[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],i=0,o=n.length;i<o;++i)n[i].value.apply(e,r)}};function ni(t,e){for(var r=0,n=t.length,i;r<n;++r)if((i=t[r]).name===e)return i.value}function Le(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=ei,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var Jt=qe;var yt="http://www.w3.org/1999/xhtml",jt={svg:"http://www.w3.org/2000/svg",xhtml:yt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function O(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),jt.hasOwnProperty(e)?{space:jt[e],local:t}:t}function ii(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===yt&&e.documentElement.namespaceURI===yt?e.createElement(t):e.createElementNS(r,t)}}function oi(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function _t(t){var e=O(t);return(e.local?oi:ii)(e)}function ai(){}function F(t){return t==null?ai:function(){return this.querySelector(t)}}function Pe(t){typeof t!="function"&&(t=F(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var o=e[i],a=o.length,u=n[i]=new Array(a),l,s,f=0;f<a;++f)(l=o[f])&&(s=t.call(l,l.__data__,f,o))&&("__data__"in l&&(s.__data__=l.__data__),u[f]=s);return new _(n,this._parents)}function te(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function si(){return[]}function et(t){return t==null?si:function(){return this.querySelectorAll(t)}}function ui(t){return function(){return te(t.apply(this,arguments))}}function De(t){typeof t=="function"?t=ui(t):t=et(t);for(var e=this._groups,r=e.length,n=[],i=[],o=0;o<r;++o)for(var a=e[o],u=a.length,l,s=0;s<u;++s)(l=a[s])&&(n.push(t.call(l,l.__data__,s,a)),i.push(l));return new _(n,i)}function rt(t){return function(){return this.matches(t)}}function wt(t){return function(e){return e.matches(t)}}var li=Array.prototype.find;function fi(t){return function(){return li.call(this.children,t)}}function ci(){return this.firstElementChild}function Fe(t){return this.select(t==null?ci:fi(typeof t=="function"?t:wt(t)))}var hi=Array.prototype.filter;function pi(){return Array.from(this.children)}function mi(t){return function(){return hi.call(this.children,t)}}function Ve(t){return this.selectAll(t==null?pi:mi(typeof t=="function"?t:wt(t)))}function Ye(t){typeof t!="function"&&(t=rt(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var o=e[i],a=o.length,u=n[i]=[],l,s=0;s<a;++s)(l=o[s])&&t.call(l,l.__data__,s,o)&&u.push(l);return new _(n,this._parents)}function vt(t){return new Array(t.length)}function Ke(){return new _(this._enter||this._groups.map(vt),this._parents)}function nt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}nt.prototype={constructor:nt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function We(t){return function(){return t}}function di(t,e,r,n,i,o){for(var a=0,u,l=e.length,s=o.length;a<s;++a)(u=e[a])?(u.__data__=o[a],n[a]=u):r[a]=new nt(t,o[a]);for(;a<l;++a)(u=e[a])&&(i[a]=u)}function xi(t,e,r,n,i,o,a){var u,l,s=new Map,f=e.length,h=o.length,c=new Array(f),p;for(u=0;u<f;++u)(l=e[u])&&(c[u]=p=a.call(l,l.__data__,u,e)+"",s.has(p)?i[u]=l:s.set(p,l));for(u=0;u<h;++u)p=a.call(t,o[u],u,o)+"",(l=s.get(p))?(n[u]=l,l.__data__=o[u],s.delete(p)):r[u]=new nt(t,o[u]);for(u=0;u<f;++u)(l=e[u])&&s.get(c[u])===l&&(i[u]=l)}function gi(t){return t.__data__}function Ge(t,e){if(!arguments.length)return Array.from(this,gi);var r=e?xi:di,n=this._parents,i=this._groups;typeof t!="function"&&(t=We(t));for(var o=i.length,a=new Array(o),u=new Array(o),l=new Array(o),s=0;s<o;++s){var f=n[s],h=i[s],c=h.length,p=yi(t.call(f,f&&f.__data__,s,n)),m=p.length,x=u[s]=new Array(m),v=a[s]=new Array(m),$=l[s]=new Array(c);r(f,h,x,v,$,p,e);for(var g=0,N=0,k,H;g<m;++g)if(k=x[g]){for(g>=N&&(N=g+1);!(H=v[N])&&++N<m;);k._next=H||null}}return a=new _(a,n),a._enter=u,a._exit=l,a}function yi(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ue(){return new _(this._exit||this._groups.map(vt),this._parents)}function Ze(t,e,r){var n=this.enter(),i=this,o=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),r==null?o.remove():r(o),n&&i?n.merge(i).order():i}function Qe(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,i=r.length,o=n.length,a=Math.min(i,o),u=new Array(i),l=0;l<a;++l)for(var s=r[l],f=n[l],h=s.length,c=u[l]=new Array(h),p,m=0;m<h;++m)(p=s[m]||f[m])&&(c[m]=p);for(;l<i;++l)u[l]=r[l];return new _(u,this._parents)}function Je(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n=t[e],i=n.length-1,o=n[i],a;--i>=0;)(a=n[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function je(t){t||(t=_i);function e(h,c){return h&&c?t(h.__data__,c.__data__):!h-!c}for(var r=this._groups,n=r.length,i=new Array(n),o=0;o<n;++o){for(var a=r[o],u=a.length,l=i[o]=new Array(u),s,f=0;f<u;++f)(s=a[f])&&(l[f]=s);l.sort(e)}return new _(i,this._parents).order()}function _i(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function tr(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function er(){return Array.from(this)}function rr(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,o=n.length;i<o;++i){var a=n[i];if(a)return a}return null}function nr(){let t=0;for(let e of this)++t;return t}function ir(){return!this.node()}function or(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i=e[r],o=0,a=i.length,u;o<a;++o)(u=i[o])&&t.call(u,u.__data__,o,i);return this}function wi(t){return function(){this.removeAttribute(t)}}function vi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function bi(t,e){return function(){this.setAttribute(t,e)}}function ki(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ai(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function Ei(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function ar(t,e){var r=O(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((e==null?r.local?vi:wi:typeof e=="function"?r.local?Ei:Ai:r.local?ki:bi)(r,e))}function bt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function $i(t){return function(){this.style.removeProperty(t)}}function Ni(t,e,r){return function(){this.style.setProperty(t,e,r)}}function Ci(t,e,r){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function sr(t,e,r){return arguments.length>1?this.each((e==null?$i:typeof e=="function"?Ci:Ni)(t,e,r==null?"":r)):L(this.node(),t)}function L(t,e){return t.style.getPropertyValue(e)||bt(t).getComputedStyle(t,null).getPropertyValue(e)}function Si(t){return function(){delete this[t]}}function Ti(t,e){return function(){this[t]=e}}function Ii(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function ur(t,e){return arguments.length>1?this.each((e==null?Si:typeof e=="function"?Ii:Ti)(t,e)):this.node()[t]}function lr(t){return t.trim().split(/^|\s+/)}function ee(t){return t.classList||new fr(t)}function fr(t){this._node=t,this._names=lr(t.getAttribute("class")||"")}fr.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function cr(t,e){for(var r=ee(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function hr(t,e){for(var r=ee(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function Mi(t){return function(){cr(this,t)}}function zi(t){return function(){hr(this,t)}}function Oi(t,e){return function(){(e.apply(this,arguments)?cr:hr)(this,t)}}function pr(t,e){var r=lr(t+"");if(arguments.length<2){for(var n=ee(this.node()),i=-1,o=r.length;++i<o;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof e=="function"?Oi:e?Mi:zi)(r,e))}function Ri(){this.textContent=""}function Bi(t){return function(){this.textContent=t}}function Hi(t){return function(){var e=t.apply(this,arguments);this.textContent=e==null?"":e}}function mr(t){return arguments.length?this.each(t==null?Ri:(typeof t=="function"?Hi:Bi)(t)):this.node().textContent}function Xi(){this.innerHTML=""}function Li(t){return function(){this.innerHTML=t}}function qi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e==null?"":e}}function dr(t){return arguments.length?this.each(t==null?Xi:(typeof t=="function"?qi:Li)(t)):this.node().innerHTML}function Pi(){this.nextSibling&&this.parentNode.appendChild(this)}function xr(){return this.each(Pi)}function Di(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gr(){return this.each(Di)}function yr(t){var e=typeof t=="function"?t:_t(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Fi(){return null}function _r(t,e){var r=typeof t=="function"?t:_t(t),n=e==null?Fi:typeof e=="function"?e:F(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function Vi(){var t=this.parentNode;t&&t.removeChild(this)}function wr(){return this.each(Vi)}function Yi(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ki(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function vr(t){return this.select(t?Ki:Yi)}function br(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Wi(t){return function(e){t.call(this,e,this.__data__)}}function Gi(t){return t.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{type:e,name:r}})}function Ui(t){return function(){var e=this.__on;if(e){for(var r=0,n=-1,i=e.length,o;r<i;++r)o=e[r],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++n]=o;++n?e.length=n:delete this.__on}}}function Zi(t,e,r){return function(){var n=this.__on,i,o=Wi(e);if(n){for(var a=0,u=n.length;a<u;++a)if((i=n[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=r),i.value=e;return}}this.addEventListener(t.type,o,r),i={type:t.type,name:t.name,value:e,listener:o,options:r},n?n.push(i):this.__on=[i]}}function kr(t,e,r){var n=Gi(t+""),i,o=n.length,a;if(arguments.length<2){var u=this.node().__on;if(u){for(var l=0,s=u.length,f;l<s;++l)for(i=0,f=u[l];i<o;++i)if((a=n[i]).type===f.type&&a.name===f.name)return f.value}return}for(u=e?Zi:Ui,i=0;i<o;++i)this.each(u(n[i],e,r));return this}function Ar(t,e,r){var n=bt(t),i=n.CustomEvent;typeof i=="function"?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Qi(t,e){return function(){return Ar(this,t,e)}}function Ji(t,e){return function(){return Ar(this,t,e.apply(this,arguments))}}function Er(t,e){return this.each((typeof e=="function"?Ji:Qi)(t,e))}function*$r(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,o=n.length,a;i<o;++i)(a=n[i])&&(yield a)}var re=[null];function _(t,e){this._groups=t,this._parents=e}function Nr(){return new _([[document.documentElement]],re)}function ji(){return this}_.prototype=Nr.prototype={constructor:_,select:Pe,selectAll:De,selectChild:Fe,selectChildren:Ve,filter:Ye,data:Ge,enter:Ke,exit:Ue,join:Ze,merge:Qe,selection:ji,order:Je,sort:je,call:tr,nodes:er,node:rr,size:nr,empty:ir,each:or,attr:ar,style:sr,property:ur,classed:pr,text:mr,html:dr,raise:xr,lower:gr,append:yr,insert:_r,remove:wr,clone:vr,datum:br,on:kr,dispatch:Er,[Symbol.iterator]:$r};var R=Nr;function ne(t){return typeof t=="string"?new _([[document.querySelector(t)]],[document.documentElement]):new _([[t]],re)}function kt(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function ie(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function at(){}var it=.7,$t=1/it,Z="\\s*([+-]?\\d+)\\s*",ot="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",z="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",to=/^#([0-9a-f]{3,8})$/,eo=new RegExp(`^rgb\\(${Z},${Z},${Z}\\)$`),ro=new RegExp(`^rgb\\(${z},${z},${z}\\)$`),no=new RegExp(`^rgba\\(${Z},${Z},${Z},${ot}\\)$`),io=new RegExp(`^rgba\\(${z},${z},${z},${ot}\\)$`),oo=new RegExp(`^hsl\\(${ot},${z},${z}\\)$`),ao=new RegExp(`^hsla\\(${ot},${z},${z},${ot}\\)$`),Cr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};kt(at,q,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Sr,formatHex:Sr,formatHex8:so,formatHsl:uo,formatRgb:Tr,toString:Tr});function Sr(){return this.rgb().formatHex()}function so(){return this.rgb().formatHex8()}function uo(){return Br(this).formatHsl()}function Tr(){return this.rgb().formatRgb()}function q(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=to.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?Ir(e):r===3?new E(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?At(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?At(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=eo.exec(t))?new E(e[1],e[2],e[3],1):(e=ro.exec(t))?new E(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=no.exec(t))?At(e[1],e[2],e[3],e[4]):(e=io.exec(t))?At(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=oo.exec(t))?Or(e[1],e[2]/100,e[3]/100,1):(e=ao.exec(t))?Or(e[1],e[2]/100,e[3]/100,e[4]):Cr.hasOwnProperty(t)?Ir(Cr[t]):t==="transparent"?new E(NaN,NaN,NaN,0):null}function Ir(t){return new E(t>>16&255,t>>8&255,t&255,1)}function At(t,e,r,n){return n<=0&&(t=e=r=NaN),new E(t,e,r,n)}function lo(t){return t instanceof at||(t=q(t)),t?(t=t.rgb(),new E(t.r,t.g,t.b,t.opacity)):new E}function Q(t,e,r,n){return arguments.length===1?lo(t):new E(t,e,r,n==null?1:n)}function E(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}kt(E,Q,ie(at,{brighter(t){return t=t==null?$t:Math.pow($t,t),new E(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?it:Math.pow(it,t),new E(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new E(Y(this.r),Y(this.g),Y(this.b),Nt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Mr,formatHex:Mr,formatHex8:fo,formatRgb:zr,toString:zr}));function Mr(){return`#${V(this.r)}${V(this.g)}${V(this.b)}`}function fo(){return`#${V(this.r)}${V(this.g)}${V(this.b)}${V((isNaN(this.opacity)?1:this.opacity)*255)}`}function zr(){let t=Nt(this.opacity);return`${t===1?"rgb(":"rgba("}${Y(this.r)}, ${Y(this.g)}, ${Y(this.b)}${t===1?")":`, ${t})`}`}function Nt(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Y(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function V(t){return t=Y(t),(t<16?"0":"")+t.toString(16)}function Or(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new M(t,e,r,n)}function Br(t){if(t instanceof M)return new M(t.h,t.s,t.l,t.opacity);if(t instanceof at||(t=q(t)),!t)return new M;if(t instanceof M)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),o=Math.max(e,r,n),a=NaN,u=o-i,l=(o+i)/2;return u?(e===o?a=(r-n)/u+(r<n)*6:r===o?a=(n-e)/u+2:a=(e-r)/u+4,u/=l<.5?o+i:2-o-i,a*=60):u=l>0&&l<1?0:a,new M(a,u,l,t.opacity)}function Hr(t,e,r,n){return arguments.length===1?Br(t):new M(t,e,r,n==null?1:n)}function M(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}kt(M,Hr,ie(at,{brighter(t){return t=t==null?$t:Math.pow($t,t),new M(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?it:Math.pow(it,t),new M(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new E(oe(t>=240?t-240:t+120,i,n),oe(t,i,n),oe(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new M(Rr(this.h),Et(this.s),Et(this.l),Nt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=Nt(this.opacity);return`${t===1?"hsl(":"hsla("}${Rr(this.h)}, ${Et(this.s)*100}%, ${Et(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Rr(t){return t=(t||0)%360,t<0?t+360:t}function Et(t){return Math.max(0,Math.min(1,t||0))}function oe(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}function ae(t,e,r,n,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*r+(1+3*t+3*o-3*a)*n+a*i)/6}function Xr(t){var e=t.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,e-1):Math.floor(r*e),i=t[n],o=t[n+1],a=n>0?t[n-1]:2*i-o,u=n<e-1?t[n+2]:2*o-i;return ae((r-n/e)*e,a,i,o,u)}}function Lr(t){var e=t.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*e),i=t[(n+e-1)%e],o=t[n%e],a=t[(n+1)%e],u=t[(n+2)%e];return ae((r-n/e)*e,i,o,a,u)}}var se=t=>()=>t;function co(t,e){return function(r){return t+r*e}}function ho(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function qr(t){return(t=+t)==1?Ct:function(e,r){return r-e?ho(e,r,t):se(isNaN(e)?r:e)}}function Ct(t,e){var r=e-t;return r?co(t,r):se(isNaN(t)?e:t)}var St=(function t(e){var r=qr(e);function n(i,o){var a=r((i=Q(i)).r,(o=Q(o)).r),u=r(i.g,o.g),l=r(i.b,o.b),s=Ct(i.opacity,o.opacity);return function(f){return i.r=a(f),i.g=u(f),i.b=l(f),i.opacity=s(f),i+""}}return n.gamma=t,n})(1);function Pr(t){return function(e){var r=e.length,n=new Array(r),i=new Array(r),o=new Array(r),a,u;for(a=0;a<r;++a)u=Q(e[a]),n[a]=u.r||0,i[a]=u.g||0,o[a]=u.b||0;return n=t(n),i=t(i),o=t(o),u.opacity=1,function(l){return u.r=n(l),u.g=i(l),u.b=o(l),u+""}}}var po=Pr(Xr),mo=Pr(Lr);function C(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}var le=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ue=new RegExp(le.source,"g");function xo(t){return function(){return t}}function go(t){return function(e){return t(e)+""}}function fe(t,e){var r=le.lastIndex=ue.lastIndex=0,n,i,o,a=-1,u=[],l=[];for(t=t+"",e=e+"";(n=le.exec(t))&&(i=ue.exec(e));)(o=i.index)>r&&(o=e.slice(r,o),u[a]?u[a]+=o:u[++a]=o),(n=n[0])===(i=i[0])?u[a]?u[a]+=i:u[++a]=i:(u[++a]=null,l.push({i:a,x:C(n,i)})),r=ue.lastIndex;return r<e.length&&(o=e.slice(r),u[a]?u[a]+=o:u[++a]=o),u.length<2?l[0]?go(l[0].x):xo(e):(e=l.length,function(s){for(var f=0,h;f<e;++f)u[(h=l[f]).i]=h.x(s);return u.join("")})}var Dr=180/Math.PI,Tt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ce(t,e,r,n,i,o){var a,u,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*r+e*n)&&(r-=t*l,n-=e*l),(u=Math.sqrt(r*r+n*n))&&(r/=u,n/=u,l/=u),t*n<e*r&&(t=-t,e=-e,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Dr,skewX:Math.atan(l)*Dr,scaleX:a,scaleY:u}}var It;function Fr(t){let e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Tt:ce(e.a,e.b,e.c,e.d,e.e,e.f)}function Vr(t){return t==null?Tt:(It||(It=document.createElementNS("http://www.w3.org/2000/svg","g")),It.setAttribute("transform",t),(t=It.transform.baseVal.consolidate())?(t=t.matrix,ce(t.a,t.b,t.c,t.d,t.e,t.f)):Tt)}function Yr(t,e,r,n){function i(s){return s.length?s.pop()+" ":""}function o(s,f,h,c,p,m){if(s!==h||f!==c){var x=p.push("translate(",null,e,null,r);m.push({i:x-4,x:C(s,h)},{i:x-2,x:C(f,c)})}else(h||c)&&p.push("translate("+h+e+c+r)}function a(s,f,h,c){s!==f?(s-f>180?f+=360:f-s>180&&(s+=360),c.push({i:h.push(i(h)+"rotate(",null,n)-2,x:C(s,f)})):f&&h.push(i(h)+"rotate("+f+n)}function u(s,f,h,c){s!==f?c.push({i:h.push(i(h)+"skewX(",null,n)-2,x:C(s,f)}):f&&h.push(i(h)+"skewX("+f+n)}function l(s,f,h,c,p,m){if(s!==h||f!==c){var x=p.push(i(p)+"scale(",null,",",null,")");m.push({i:x-4,x:C(s,h)},{i:x-2,x:C(f,c)})}else(h!==1||c!==1)&&p.push(i(p)+"scale("+h+","+c+")")}return function(s,f){var h=[],c=[];return s=t(s),f=t(f),o(s.translateX,s.translateY,f.translateX,f.translateY,h,c),a(s.rotate,f.rotate,h,c),u(s.skewX,f.skewX,h,c),l(s.scaleX,s.scaleY,f.scaleX,f.scaleY,h,c),s=f=null,function(p){for(var m=-1,x=c.length,v;++m<x;)h[(v=c[m]).i]=v.x(p);return h.join("")}}}var he=Yr(Fr,"px, ","px)","deg)"),pe=Yr(Vr,", ",")",")");var J=0,ut=0,st=0,Wr=1e3,Mt,lt,zt=0,K=0,Ot=0,ft=typeof performance=="object"&&performance.now?performance:Date,Gr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ht(){return K||(Gr(yo),K=ft.now()+Ot)}function yo(){K=0}function ct(){this._call=this._time=this._next=null}ct.prototype=Rt.prototype={constructor:ct,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?ht():+r)+(e==null?0:+e),!this._next&&lt!==this&&(lt?lt._next=this:Mt=this,lt=this),this._call=t,this._time=r,me()},stop:function(){this._call&&(this._call=null,this._time=1/0,me())}};function Rt(t,e,r){var n=new ct;return n.restart(t,e,r),n}function Ur(){ht(),++J;for(var t=Mt,e;t;)(e=K-t._time)>=0&&t._call.call(void 0,e),t=t._next;--J}function Kr(){K=(zt=ft.now())+Ot,J=ut=0;try{Ur()}finally{J=0,wo(),K=0}}function _o(){var t=ft.now(),e=t-zt;e>Wr&&(Ot-=e,zt=t)}function wo(){for(var t,e=Mt,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:Mt=r);lt=t,me(n)}function me(t){if(!J){ut&&(ut=clearTimeout(ut));var e=t-K;e>24?(t<1/0&&(ut=setTimeout(Kr,t-ft.now()-Ot)),st&&(st=clearInterval(st))):(st||(zt=ft.now(),st=setInterval(_o,Wr)),J=1,Gr(Kr))}}function Bt(t,e,r){var n=new ct;return e=e==null?0:+e,n.restart(i=>{n.stop(),t(i+e)},e,r),n}var vo=Jt("start","end","cancel","interrupt"),bo=[],Jr=0,Zr=1,Xt=2,Ht=3,Qr=4,Lt=5,pt=6;function P(t,e,r,n,i,o){var a=t.__transition;if(!a)t.__transition={};else if(r in a)return;ko(t,r,{name:e,index:n,group:i,on:vo,tween:bo,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Jr})}function mt(t,e){var r=w(t,e);if(r.state>Jr)throw new Error("too late; already scheduled");return r}function b(t,e){var r=w(t,e);if(r.state>Ht)throw new Error("too late; already running");return r}function w(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function ko(t,e,r){var n=t.__transition,i;n[e]=r,r.timer=Rt(o,0,r.time);function o(s){r.state=Zr,r.timer.restart(a,r.delay,r.time),r.delay<=s&&a(s-r.delay)}function a(s){var f,h,c,p;if(r.state!==Zr)return l();for(f in n)if(p=n[f],p.name===r.name){if(p.state===Ht)return Bt(a);p.state===Qr?(p.state=pt,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete n[f]):+f<e&&(p.state=pt,p.timer.stop(),p.on.call("cancel",t,t.__data__,p.index,p.group),delete n[f])}if(Bt(function(){r.state===Ht&&(r.state=Qr,r.timer.restart(u,r.delay,r.time),u(s))}),r.state=Xt,r.on.call("start",t,t.__data__,r.index,r.group),r.state===Xt){for(r.state=Ht,i=new Array(c=r.tween.length),f=0,h=-1;f<c;++f)(p=r.tween[f].value.call(t,t.__data__,r.index,r.group))&&(i[++h]=p);i.length=h+1}}function u(s){for(var f=s<r.duration?r.ease.call(null,s/r.duration):(r.timer.restart(l),r.state=Lt,1),h=-1,c=i.length;++h<c;)i[h].call(t,f);r.state===Lt&&(r.on.call("end",t,t.__data__,r.index,r.group),l())}function l(){r.state=pt,r.timer.stop(),delete n[e];for(var s in n)return;delete t.__transition}}function qt(t,e){var r=t.__transition,n,i,o=!0,a;if(r){e=e==null?null:e+"";for(a in r){if((n=r[a]).name!==e){o=!1;continue}i=n.state>Xt&&n.state<Lt,n.state=pt,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[a]}o&&delete t.__transition}}function jr(t){return this.each(function(){qt(this,t)})}function Ao(t,e){var r,n;return function(){var i=b(this,t),o=i.tween;if(o!==r){n=r=o;for(var a=0,u=n.length;a<u;++a)if(n[a].name===e){n=n.slice(),n.splice(a,1);break}}i.tween=n}}function Eo(t,e,r){var n,i;if(typeof r!="function")throw new Error;return function(){var o=b(this,t),a=o.tween;if(a!==n){i=(n=a).slice();for(var u={name:e,value:r},l=0,s=i.length;l<s;++l)if(i[l].name===e){i[l]=u;break}l===s&&i.push(u)}o.tween=i}}function tn(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n=w(this.node(),r).tween,i=0,o=n.length,a;i<o;++i)if((a=n[i]).name===t)return a.value;return null}return this.each((e==null?Ao:Eo)(r,t,e))}function j(t,e,r){var n=t._id;return t.each(function(){var i=b(this,n);(i.value||(i.value={}))[e]=r.apply(this,arguments)}),function(i){return w(i,n).value[e]}}function Pt(t,e){var r;return(typeof e=="number"?C:e instanceof q?St:(r=q(e))?(e=r,St):fe)(t,e)}function $o(t){return function(){this.removeAttribute(t)}}function No(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Co(t,e,r){var n,i=r+"",o;return function(){var a=this.getAttribute(t);return a===i?null:a===n?o:o=e(n=a,r)}}function So(t,e,r){var n,i=r+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===n?o:o=e(n=a,r)}}function To(t,e,r){var n,i,o;return function(){var a,u=r(this),l;return u==null?void this.removeAttribute(t):(a=this.getAttribute(t),l=u+"",a===l?null:a===n&&l===i?o:(i=l,o=e(n=a,u)))}}function Io(t,e,r){var n,i,o;return function(){var a,u=r(this),l;return u==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),l=u+"",a===l?null:a===n&&l===i?o:(i=l,o=e(n=a,u)))}}function en(t,e){var r=O(t),n=r==="transform"?pe:Pt;return this.attrTween(t,typeof e=="function"?(r.local?Io:To)(r,n,j(this,"attr."+t,e)):e==null?(r.local?No:$o)(r):(r.local?So:Co)(r,n,e))}function Mo(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function zo(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function Oo(t,e){var r,n;function i(){var o=e.apply(this,arguments);return o!==n&&(r=(n=o)&&zo(t,o)),r}return i._value=e,i}function Ro(t,e){var r,n;function i(){var o=e.apply(this,arguments);return o!==n&&(r=(n=o)&&Mo(t,o)),r}return i._value=e,i}function rn(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var n=O(t);return this.tween(r,(n.local?Oo:Ro)(n,e))}function Bo(t,e){return function(){mt(this,t).delay=+e.apply(this,arguments)}}function Ho(t,e){return e=+e,function(){mt(this,t).delay=e}}function nn(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Bo:Ho)(e,t)):w(this.node(),e).delay}function Xo(t,e){return function(){b(this,t).duration=+e.apply(this,arguments)}}function Lo(t,e){return e=+e,function(){b(this,t).duration=e}}function on(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Xo:Lo)(e,t)):w(this.node(),e).duration}function qo(t,e){if(typeof e!="function")throw new Error;return function(){b(this,t).ease=e}}function an(t){var e=this._id;return arguments.length?this.each(qo(e,t)):w(this.node(),e).ease}function Po(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;b(this,t).ease=r}}function sn(t){if(typeof t!="function")throw new Error;return this.each(Po(this._id,t))}function un(t){typeof t!="function"&&(t=rt(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var o=e[i],a=o.length,u=n[i]=[],l,s=0;s<a;++s)(l=o[s])&&t.call(l,l.__data__,s,o)&&u.push(l);return new A(n,this._parents,this._name,this._id)}function ln(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,i=r.length,o=Math.min(n,i),a=new Array(n),u=0;u<o;++u)for(var l=e[u],s=r[u],f=l.length,h=a[u]=new Array(f),c,p=0;p<f;++p)(c=l[p]||s[p])&&(h[p]=c);for(;u<n;++u)a[u]=e[u];return new A(a,this._parents,this._name,this._id)}function Do(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function Fo(t,e,r){var n,i,o=Do(e)?mt:b;return function(){var a=o(this,t),u=a.on;u!==n&&(i=(n=u).copy()).on(e,r),a.on=i}}function fn(t,e){var r=this._id;return arguments.length<2?w(this.node(),r).on.on(t):this.each(Fo(r,t,e))}function Vo(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function cn(){return this.on("end.remove",Vo(this._id))}function hn(t){var e=this._name,r=this._id;typeof t!="function"&&(t=F(t));for(var n=this._groups,i=n.length,o=new Array(i),a=0;a<i;++a)for(var u=n[a],l=u.length,s=o[a]=new Array(l),f,h,c=0;c<l;++c)(f=u[c])&&(h=t.call(f,f.__data__,c,u))&&("__data__"in f&&(h.__data__=f.__data__),s[c]=h,P(s[c],e,r,c,s,w(f,r)));return new A(o,this._parents,e,r)}function pn(t){var e=this._name,r=this._id;typeof t!="function"&&(t=et(t));for(var n=this._groups,i=n.length,o=[],a=[],u=0;u<i;++u)for(var l=n[u],s=l.length,f,h=0;h<s;++h)if(f=l[h]){for(var c=t.call(f,f.__data__,h,l),p,m=w(f,r),x=0,v=c.length;x<v;++x)(p=c[x])&&P(p,e,r,x,c,m);o.push(c),a.push(f)}return new A(o,a,e,r)}var Yo=R.prototype.constructor;function mn(){return new Yo(this._groups,this._parents)}function Ko(t,e){var r,n,i;return function(){var o=L(this,t),a=(this.style.removeProperty(t),L(this,t));return o===a?null:o===r&&a===n?i:i=e(r=o,n=a)}}function dn(t){return function(){this.style.removeProperty(t)}}function Wo(t,e,r){var n,i=r+"",o;return function(){var a=L(this,t);return a===i?null:a===n?o:o=e(n=a,r)}}function Go(t,e,r){var n,i,o;return function(){var a=L(this,t),u=r(this),l=u+"";return u==null&&(l=u=(this.style.removeProperty(t),L(this,t))),a===l?null:a===n&&l===i?o:(i=l,o=e(n=a,u))}}function Uo(t,e){var r,n,i,o="style."+e,a="end."+o,u;return function(){var l=b(this,t),s=l.on,f=l.value[o]==null?u||(u=dn(e)):void 0;(s!==r||i!==f)&&(n=(r=s).copy()).on(a,i=f),l.on=n}}function xn(t,e,r){var n=(t+="")=="transform"?he:Pt;return e==null?this.styleTween(t,Ko(t,n)).on("end.style."+t,dn(t)):typeof e=="function"?this.styleTween(t,Go(t,n,j(this,"style."+t,e))).each(Uo(this._id,t)):this.styleTween(t,Wo(t,n,e),r).on("end.style."+t,null)}function Zo(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function Qo(t,e,r){var n,i;function o(){var a=e.apply(this,arguments);return a!==i&&(n=(i=a)&&Zo(t,a,r)),n}return o._value=e,o}function gn(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,Qo(t,e,r==null?"":r))}function Jo(t){return function(){this.textContent=t}}function jo(t){return function(){var e=t(this);this.textContent=e==null?"":e}}function yn(t){return this.tween("text",typeof t=="function"?jo(j(this,"text",t)):Jo(t==null?"":t+""))}function ta(t){return function(e){this.textContent=t.call(this,e)}}function ea(t){var e,r;function n(){var i=t.apply(this,arguments);return i!==r&&(e=(r=i)&&ta(i)),e}return n._value=t,n}function _n(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,ea(t))}function wn(){for(var t=this._name,e=this._id,r=Dt(),n=this._groups,i=n.length,o=0;o<i;++o)for(var a=n[o],u=a.length,l,s=0;s<u;++s)if(l=a[s]){var f=w(l,e);P(l,t,r,s,a,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new A(n,this._parents,t,r)}function vn(){var t,e,r=this,n=r._id,i=r.size();return new Promise(function(o,a){var u={value:a},l={value:function(){--i===0&&o()}};r.each(function(){var s=b(this,n),f=s.on;f!==t&&(e=(t=f).copy(),e._.cancel.push(u),e._.interrupt.push(u),e._.end.push(l)),s.on=e}),i===0&&o()})}var ra=0;function A(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function bn(t){return R().transition(t)}function Dt(){return++ra}var B=R.prototype;A.prototype=bn.prototype={constructor:A,select:hn,selectAll:pn,selectChild:B.selectChild,selectChildren:B.selectChildren,filter:un,merge:ln,selection:mn,transition:wn,call:B.call,nodes:B.nodes,node:B.node,size:B.size,empty:B.empty,each:B.each,on:fn,attr:en,attrTween:rn,style:xn,styleTween:gn,text:yn,textTween:_n,remove:cn,tween:tn,delay:nn,duration:on,ease:an,easeVarying:sn,end:vn,[Symbol.iterator]:B[Symbol.iterator]};function Ft(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var na={time:null,delay:0,duration:250,ease:Ft};function ia(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function kn(t){var e,r;t instanceof A?(e=t._id,t=t._name):(e=Dt(),(r=na).time=ht(),t=t==null?null:t+"");for(var n=this._groups,i=n.length,o=0;o<i;++o)for(var a=n[o],u=a.length,l,s=0;s<u;++s)(l=a[s])&&P(l,t,e,s,a,r||ia(l,e));return new A(n,this._parents,t,e)}R.prototype.interrupt=jr;R.prototype.transition=kn;var{abs:bc,max:kc,min:Ac}=Math;function An(t){return[+t[0],+t[1]]}function oa(t){return[An(t[0]),An(t[1])]}var Ec={name:"x",handles:["w","e"].map(de),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},$c={name:"y",handles:["n","s"].map(de),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Nc={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(de),input:function(t){return t==null?null:oa(t)},output:function(t){return t}};function de(t){return{type:t}}var xe=Math.PI,ge=2*xe,W=1e-6,aa=ge-W;function En(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function sa(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return En;let r=10**e;return function(n){this._+=n[0];for(let i=1,o=n.length;i<o;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}var G=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?En:sa(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,o,a){this._append`C${+e},${+r},${+n},${+i},${this._x1=+o},${this._y1=+a}`}arcTo(e,r,n,i,o){if(e=+e,r=+r,n=+n,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let a=this._x1,u=this._y1,l=n-e,s=i-r,f=a-e,h=u-r,c=f*f+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(c>W)if(!(Math.abs(h*l-s*f)>W)||!o)this._append`L${this._x1=e},${this._y1=r}`;else{let p=n-a,m=i-u,x=l*l+s*s,v=p*p+m*m,$=Math.sqrt(x),g=Math.sqrt(c),N=o*Math.tan((xe-Math.acos((x+c-v)/(2*$*g)))/2),k=N/g,H=N/$;Math.abs(k-1)>W&&this._append`L${e+k*f},${r+k*h}`,this._append`A${o},${o},0,0,${+(h*p>f*m)},${this._x1=e+H*l},${this._y1=r+H*s}`}}arc(e,r,n,i,o,a){if(e=+e,r=+r,n=+n,a=!!a,n<0)throw new Error(`negative radius: ${n}`);let u=n*Math.cos(i),l=n*Math.sin(i),s=e+u,f=r+l,h=1^a,c=a?i-o:o-i;this._x1===null?this._append`M${s},${f}`:(Math.abs(this._x1-s)>W||Math.abs(this._y1-f)>W)&&this._append`L${s},${f}`,n&&(c<0&&(c=c%ge+ge),c>aa?this._append`A${n},${n},0,1,${h},${e-u},${r-l}A${n},${n},0,1,${h},${this._x1=s},${this._y1=f}`:c>W&&this._append`A${n},${n},0,${+(c>=xe)},${h},${this._x1=e+n*Math.cos(o)},${this._y1=r+n*Math.sin(o)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}};function $n(){return new G}$n.prototype=G.prototype;function ua(t){var e=0,r=t.children,n=r&&r.length;if(!n)e=1;else for(;--n>=0;)e+=r[n].value;t.value=e}function Nn(){return this.eachAfter(ua)}function Cn(t,e){let r=-1;for(let n of this)t.call(e,n,++r,this);return this}function Sn(t,e){for(var r=this,n=[r],i,o,a=-1;r=n.pop();)if(t.call(e,r,++a,this),i=r.children)for(o=i.length-1;o>=0;--o)n.push(i[o]);return this}function Tn(t,e){for(var r=this,n=[r],i=[],o,a,u,l=-1;r=n.pop();)if(i.push(r),o=r.children)for(a=0,u=o.length;a<u;++a)n.push(o[a]);for(;r=i.pop();)t.call(e,r,++l,this);return this}function In(t,e){let r=-1;for(let n of this)if(t.call(e,n,++r,this))return n}function Mn(t){return this.eachAfter(function(e){for(var r=+t(e.data)||0,n=e.children,i=n&&n.length;--i>=0;)r+=n[i].value;e.value=r})}function zn(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function On(t){for(var e=this,r=la(e,t),n=[e];e!==r;)e=e.parent,n.push(e);for(var i=n.length;t!==r;)n.splice(i,0,t),t=t.parent;return n}function la(t,e){if(t===e)return t;var r=t.ancestors(),n=e.ancestors(),i=null;for(t=r.pop(),e=n.pop();t===e;)i=t,t=r.pop(),e=n.pop();return i}function Rn(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function Bn(){return Array.from(this)}function Hn(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function Xn(){var t=this,e=[];return t.each(function(r){r!==t&&e.push({source:r.parent,target:r})}),e}function*Ln(){var t=this,e,r=[t],n,i,o;do for(e=r.reverse(),r=[];t=e.pop();)if(yield t,n=t.children)for(i=0,o=n.length;i<o;++i)r.push(n[i]);while(r.length)}function tt(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=ha)):e===void 0&&(e=ca);for(var r=new U(t),n,i=[r],o,a,u,l;n=i.pop();)if((a=e(n.data))&&(l=(a=Array.from(a)).length))for(n.children=a,u=l-1;u>=0;--u)i.push(o=a[u]=new U(a[u])),o.parent=n,o.depth=n.depth+1;return r.eachBefore(ma)}function fa(){return tt(this).eachBefore(pa)}function ca(t){return t.children}function ha(t){return Array.isArray(t)?t[1]:null}function pa(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function ma(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function U(t){this.data=t,this.depth=this.height=0,this.parent=null}U.prototype=tt.prototype={constructor:U,count:Nn,each:Cn,eachAfter:Tn,eachBefore:Sn,find:In,sum:Mn,sort:zn,path:On,ancestors:Rn,descendants:Bn,leaves:Hn,links:Xn,copy:fa,[Symbol.iterator]:Ln};function da(t,e){return t.parent===e.parent?1:2}function ye(t){var e=t.children;return e?e[0]:t.t}function _e(t){var e=t.children;return e?e[e.length-1]:t.t}function xa(t,e,r){var n=r/(e.i-t.i);e.c-=n,e.s+=r,t.c+=n,e.z+=r,e.m+=r}function ga(t){for(var e=0,r=0,n=t.children,i=n.length,o;--i>=0;)o=n[i],o.z+=e,o.m+=e,e+=o.s+(r+=o.c)}function ya(t,e,r){return t.a.parent===e.parent?t.a:r}function Vt(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}Vt.prototype=Object.create(U.prototype);function _a(t){for(var e=new Vt(t,0),r,n=[e],i,o,a,u;r=n.pop();)if(o=r._.children)for(r.children=new Array(u=o.length),a=u-1;a>=0;--a)n.push(i=r.children[a]=new Vt(o[a],a)),i.parent=r;return(e.parent=new Vt(null,0)).children=[e],e}function we(){var t=da,e=1,r=1,n=null;function i(s){var f=_a(s);if(f.eachAfter(o),f.parent.m=-f.z,f.eachBefore(a),n)s.eachBefore(l);else{var h=s,c=s,p=s;s.eachBefore(function(g){g.x<h.x&&(h=g),g.x>c.x&&(c=g),g.depth>p.depth&&(p=g)});var m=h===c?1:t(h,c)/2,x=m-h.x,v=e/(c.x+m+x),$=r/(p.depth||1);s.eachBefore(function(g){g.x=(g.x+x)*v,g.y=g.depth*$})}return s}function o(s){var f=s.children,h=s.parent.children,c=s.i?h[s.i-1]:null;if(f){ga(s);var p=(f[0].z+f[f.length-1].z)/2;c?(s.z=c.z+t(s._,c._),s.m=s.z-p):s.z=p}else c&&(s.z=c.z+t(s._,c._));s.parent.A=u(s,c,s.parent.A||h[0])}function a(s){s._.x=s.z+s.parent.m,s.m+=s.parent.m}function u(s,f,h){if(f){for(var c=s,p=s,m=f,x=c.parent.children[0],v=c.m,$=p.m,g=m.m,N=x.m,k;m=_e(m),c=ye(c),m&&c;)x=ye(x),p=_e(p),p.a=s,k=m.z+g-c.z-v+t(m._,c._),k>0&&(xa(ya(m,s,h),s,k),v+=k,$+=k),g+=m.m,v+=c.m,N+=x.m,$+=p.m;m&&!_e(p)&&(p.t=m,p.m+=g-$),c&&!ye(x)&&(x.t=c,x.m+=v-N,h=s)}return h}function l(s){s.x*=e,s.y=s.depth*r}return i.separation=function(s){return arguments.length?(t=s,i):t},i.size=function(s){return arguments.length?(n=!1,e=+s[0],r=+s[1],i):n?null:[e,r]},i.nodeSize=function(s){return arguments.length?(n=!0,e=+s[0],r=+s[1],i):n?[e,r]:null},i}function ve(t){return function(){return t}}function qn(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{let n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new G(e)}var Pn=Array.prototype.slice;function Dn(t){return t[0]}function Fn(t){return t[1]}var be=class{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}};function Vn(t){return new be(t,!0)}function wa(t){return t.source}function va(t){return t.target}function Yn(t){let e=wa,r=va,n=Dn,i=Fn,o=null,a=null,u=qn(l);function l(){let s,f=Pn.call(arguments),h=e.apply(this,f),c=r.apply(this,f);if(o==null&&(a=t(s=u())),a.lineStart(),f[0]=h,a.point(+n.apply(this,f),+i.apply(this,f)),f[0]=c,a.point(+n.apply(this,f),+i.apply(this,f)),a.lineEnd(),s)return a=null,s+""||null}return l.source=function(s){return arguments.length?(e=s,l):e},l.target=function(s){return arguments.length?(r=s,l):r},l.x=function(s){return arguments.length?(n=typeof s=="function"?s:ve(+s),l):n},l.y=function(s){return arguments.length?(i=typeof s=="function"?s:ve(+s),l):i},l.context=function(s){return arguments.length?(s==null?o=a=null:a=t(o=s),l):o},l}function ke(){return Yn(Vn)}function D(t,e,r){this.k=t,this.x=e,this.y=r}D.prototype={constructor:D,scale:function(t){return t===1?this:new D(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new D(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ae=new D(1,0,0);Ee.prototype=D.prototype;function Ee(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Ae;return t.__zoom}function ka(){let t=document.getElementById("viz");return t||(t=document.createElement("div"),t.id="viz",document.body.appendChild(t)),t}function Aa(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function S(t,e,r){try{let n=t.style&&t.style[e];return n==null||n===""?r:n}catch(n){return r}}function Ea(t,e,r){var a;let n={name:"root",children:[],value:0},i=(u,l)=>{u.children||(u.children=[]);let s=u.children.find(f=>f.name===l);return s||(s={name:l,children:[],value:0},u.children.push(s)),s};for(let u of t){let l=n;for(let f of e){let h=u[f]&&u[f].value!=null?String(u[f].value):"(null)";l=i(l,h)}let s=r?Number((a=u[r])==null?void 0:a.value)||0:1;l.value+=s}function o(u){if(!u.children||u.children.length===0)return u.value||0;let l=0;for(let s of u.children)l+=o(s);return u.value=l,l}return o(n),n}function $a(t){var Ie,Me,ze,Oe,Re,Be;let e=ka();Aa(e);let r=window.dscc;if(!r){e.innerHTML="<div style='padding:12px'>dscc introuvable. V\xE9rifie que dscc.min.js est bien concat\xE9n\xE9 dans dist/viz.js.</div>";return}let n=r.getWidth(),i=r.getHeight(),o=((Ie=t.fields)==null?void 0:Ie.dims)||((Me=t.fields)==null?void 0:Me.dimensions)||[],a=((ze=t.fields)==null?void 0:ze.metric)||((Oe=t.fields)==null?void 0:Oe.metrics)||[],u=Array.isArray(o)?o:[],l=Array.isArray(a)?a:[],s=u.map(y=>y.id),f=l.length>0?l[0].id:null,h=((Re=t.tables)==null?void 0:Re.DEFAULT)||[];if(!s||s.length<2){e.innerHTML="<div style='padding:12px'>Ajoute au moins <b>2 dimensions</b> pour construire l\u2019arbre.</div>";return}if(!h.length){e.innerHTML="<div style='padding:12px'>Aucune donn\xE9e.</div>";return}let c=!!S(t,"showValue",!1),p=Number(S(t,"fontSize",12)),m=S(t,"fontFamily","Inter, Arial, sans-serif"),x=Number(S(t,"nodeRadius",4)),v=Number(S(t,"indent",180)),$=Number(S(t,"rowHeight",24)),g=Number(S(t,"linkWidth",1.5)),N=S(t,"backgroundColor","#ffffff"),k=S(t,"labelColor","#111111"),H=S(t,"linkColor","#9aa4b5"),$e=S(t,"nodeColor","#6c8cf5"),Ne=S(t,"nodeCollapsedColor","#324679"),Kn=Ea(h,s,f);e.style.background=N,e.style.color=k,e.style.fontFamily=m;let dt=document.createElement("div");dt.className="viz-container",e.appendChild(dt);let xt=document.createElement("div");xt.className="meta-panel";let Wn=s.length?s.map(y=>{var X;return`<span class="pill">${((X=u.find(Kt=>Kt.id===y))==null?void 0:X.name)||y}</span>`}).join(" "):'<span class="pill empty">Aucune dimension</span>',Gn=f?`<span class="pill metric">${((Be=l.find(y=>y.id===f))==null?void 0:Be.name)||f}</span>`:'<span class="pill metric empty">Aucune m\xE9trique</span>';xt.innerHTML=`<strong>Dimensions :</strong> ${Wn} &nbsp; <strong>M\xE9trique :</strong> ${Gn}`,dt.appendChild(xt);let Ce=ne(dt).append("svg").attr("width",n),Se=Ce.append("g").attr("transform","translate(20,20)"),Un=$,Zn=v,T=tt(Kn);T.x0=0,T.y0=0,T.descendants().forEach(y=>{y.id=y.id||Math.random().toString(16).slice(2),y._children=y.children,y.depth>1&&(y.children=null)});let Qn=we().nodeSize([Un,Zn]);function Yt(y){return ke().x(X=>X.y).y(X=>X.x)(y)}function Te(y){let X=T.descendants(),Kt=T.links();Qn(T);let Wt=T,Gt=T;T.eachBefore(d=>{d.x<Wt.x&&(Wt=d),d.x>Gt.x&&(Gt=d)});let Jn=Gt.x-Wt.x+40,jn=xt.offsetHeight||0,ti=Math.max(i-jn-16,Jn);Ce.attr("height",ti);let Ut=Se.selectAll("g.node").data(X,d=>d.id),Zt=Ut.enter().append("g").attr("class","node").attr("transform",()=>`translate(${y.y0},${y.x0})`).on("click",(d,I)=>{I.children?(I._children=I.children,I.children=null):(I.children=I._children,I._children=null),Te(I)});Zt.append("circle").attr("r",x).attr("fill",d=>d._children?Ne:$e),Zt.append("text").attr("dy","0.32em").attr("x",d=>d._children?-10:10).attr("text-anchor",d=>d._children?"end":"start").style("font-size",`${p}px`).style("fill",k).style("font-family",m).text(d=>{var Xe;if(d.depth===0)return"";let I=d.data.name;return c?`${I} (${(Xe=d.value)!=null?Xe:0})`:I});let He=Zt.merge(Ut);He.transition().duration(250).attr("transform",d=>`translate(${d.y},${d.x})`),He.select("circle").attr("fill",d=>d._children?Ne:$e),Ut.exit().transition().duration(250).attr("transform",()=>`translate(${y.y},${y.x})`).remove();let Qt=Se.selectAll("path.link").data(Kt,d=>d.target.id);Qt.enter().append("path").attr("class","link").attr("stroke",H).attr("stroke-width",g).attr("d",()=>{let d={x:y.x0,y:y.y0};return Yt({source:d,target:d})}).merge(Qt).transition().duration(250).attr("d",Yt).attr("stroke",H).attr("stroke-width",g),Qt.exit().transition().duration(250).attr("d",()=>{let d={x:y.x,y:y.y};return Yt({source:d,target:d})}).remove(),T.eachBefore(d=>{d.x0=d.x,d.y0=d.y})}Te(T)}(function(){let e=window.dscc;e&&e.subscribeToData($a,{transform:e.objectTransform})})();})();

