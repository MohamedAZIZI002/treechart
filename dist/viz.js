!function(e,R){"object"==typeof exports&&"object"==typeof module?module.exports=R():"function"==typeof define&&define.amd?define("dscc",[],R):"object"==typeof exports?exports.dscc=R():e.dscc=R()}(window,function(){return t={},n.m=C={"./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/*! no static exports found */function(e,N,R){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var R,C=1,t=arguments.length;C<t;C++)for(var n in R=arguments[C])Object.prototype.hasOwnProperty.call(R,n)&&(e[n]=R[n]);return e}).apply(this,arguments)};Object.defineProperty(N,"__esModule",{value:!0});
/*!
  @license
  Copyright 2019 Google LLC

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
*/
var _=R(/*! ./types */"./src/types.ts");!function(e){for(var R in e)N.hasOwnProperty(R)||(N[R]=e[R])}(R(/*! ./types */"./src/types.ts")),N.getWidth=function(){return document.body.clientWidth},N.getHeight=function(){return document.documentElement.clientHeight},N.getComponentId=function(){var e=new URLSearchParams(window.location.search);if(null!==e.get("dscId"))return e.get("dscId");throw new Error("dscId must be in the query parameters. This is a bug in ds-component, please file a bug: https://github.com/googledatastudio/ds-component/issues/new")};function E(e){return e.type===_.ConfigDataElementType.DIMENSION||e.type===_.ConfigDataElementType.METRIC}function r(e){return e===_.ConfigDataElementType.DIMENSION?-1:1}function a(e){var R=[];e.config.data.forEach(function(e){e.elements.filter(E).forEach(function(e){R.push(e)})});var C,t=(C=function(e,R){return r(e.type)-r(R.type)},R.map(function(e,R){return{item:e,index:R}}).sort(function(e,R){return C(e.item,R.item)||e.index-R.index}).map(function(e){return e.item})),n=[];return t.forEach(function(e){e.value.forEach(function(){return n.push(e.id)})}),n}function o(R){return function(e){var C,t,n={};return t=R,((C=e).length<t.length?C.map(function(e,R){return[e,t[R]]}):t.map(function(e,R){return[C[R],e]})).forEach(function(e){var R=e[0],C=e[1];void 0===n[C]&&(n[C]=[]),n[C].push(R)},{}),n}}N.fieldsByConfigId=function(e){var R=e.fields.reduce(function(e,R){return e[R.id]=R,e},{}),C={};return e.config.data.forEach(function(e){e.elements.filter(E).forEach(function(e){C[e.id]=e.value.map(function(e){return R[e]})})}),C};function U(e){var R={};return(e.config.style||[]).forEach(function(e){e.elements.forEach(function(e){if(void 0!==R[e.id])throw new Error("styleIds must be unique. Your styleId: '"+e.id+"' is used more than once.");R[e.id]={value:e.value,defaultValue:e.defaultValue}})},{}),R}function Y(e){return e.config.themeStyle}function n(e){switch(e){case _.DSInteractionType.FILTER:return _.InteractionType.FILTER}}function s(e){var R=e.config.interactions;return void 0===R?{}:R.reduce(function(e,R){var C=R.supportedActions.map(n),t={type:n(R.value.type),data:R.value.data};return e[R.id]={value:t,supportedActions:C},e},{})}N.tableTransform=function(e){return{tables:(R=e,t=N.fieldsByConfigId(R),n=a(R),E={},r=n.map(function(e){void 0===E[e]?E[e]=0:E[e]++;var R=E[e],C=t[e][R];return i(i({},C),{configId:e})}),(C={})[_.TableType.DEFAULT]={headers:[],rows:[]},o=C,R.dataResponse.tables.forEach(function(e){o[e.id]={headers:r,rows:e.rows}}),o),fields:N.fieldsByConfigId(e),style:U(e),theme:Y(e),interactions:s(e)};var R,C,t,n,E,r,o},N.objectTransform=function(e){return{tables:(t=a(R=e),(C={})[_.TableType.DEFAULT]=[],n=C,R.dataResponse.tables.forEach(function(e){var R=e.rows.map(o(t));e.id===_.TableType.DEFAULT?n[e.id]=R:(void 0===n[e.id]&&(n[e.id]=[]),n[e.id]=n[e.id].concat(R))}),n),fields:N.fieldsByConfigId(e),style:U(e),theme:Y(e),interactions:s(e)};var R,C,t,n};function u(e){var R,C=!1;return e===N.tableTransform||e===N.objectTransform?C=!0:(R=!1,"identity"===e("identity")&&(R=!0,console.warn("This is an unsupported data format. Please use one of the supported transforms:\n       dscc.objectFormat or dscc.tableFormat.")),R&&(C=!0)),C}N.subscribeToData=function(R,C){if(u(C.transform)){var e=function(e){e.data.type===_.MessageType.RENDER?R(C.transform(e.data)):console.error("MessageType: "+e.data.type+" is not supported by this version of the library.")};window.addEventListener("message",e);var t={componentId:N.getComponentId(),type:_.ToDSMessageType.VIZ_READY};return window.parent.postMessage(t,"*"),function(){return window.removeEventListener("message",e)}}throw new Error("Only the built in transform functions are supported.")},N.sendInteraction=function(e,R,C){var t=N.getComponentId(),n={type:_.ToDSMessageType.INTERACTION,id:e,data:C,componentId:t};window.parent.postMessage(n,"*")},N.clearInteraction=function(e,R){N.sendInteraction(e,R,void 0)}},"./src/types.ts":
/*!**********************!*\
  !*** ./src/types.ts ***!
  \**********************/
/*! no static exports found */function(e,R,C){"use strict";var t,n,E,r,o,N;Object.defineProperty(R,"__esModule",{value:!0}),(t=R.ConceptType||(R.ConceptType={})).METRIC="METRIC",t.DIMENSION="DIMENSION",(R.MessageType||(R.MessageType={})).RENDER="RENDER",(n=R.FieldType||(R.FieldType={})).YEAR="YEAR",n.YEAR_QUARTER="YEAR_QUARTER",n.YEAR_MONTH="YEAR_MONTH",n.YEAR_WEEK="YEAR_WEEK",n.YEAR_MONTH_DAY="YEAR_MONTH_DAY",n.YEAR_MONTH_DAY_HOUR="YEAR_MONTH_DAY_HOUR",n.QUARTER="QUARTER",n.MONTH="MONTH",n.WEEK="WEEK",n.MONTH_DAY="MONTH_DAY",n.DAY_OF_WEEK="DAY_OF_WEEK",n.DAY="DAY",n.HOUR="HOUR",n.MINUTE="MINUTE",n.DURATION="DURATION",n.COUNTRY="COUNTRY",n.COUNTRY_CODE="COUNTRY_CODE",n.CONTINENT="CONTINENT",n.CONTINENT_CODE="CONTINENT_CODE",n.SUB_CONTINENT="SUB_CONTINENT",n.SUB_CONTINENT_CODE="SUB_CONTINENT_CODE",n.REGION="REGION",n.REGION_CODE="REGION_CODE",n.CITY="CITY",n.CITY_CODE="CITY_CODE",n.METRO_CODE="METRO_CODE",n.LATITUDE_LONGITUDE="LATITUDE_LONGITUDE",n.NUMBER="NUMBER",n.PERCENT="PERCENT",n.TEXT="TEXT",n.BOOLEAN="BOOLEAN",n.URL="URL",n.IMAGE="IMAGE",n.CURRENCY_AED="CURRENCY_AED",n.CURRENCY_ALL="CURRENCY_ALL",n.CURRENCY_ARS="CURRENCY_ARS",n.CURRENCY_AUD="CURRENCY_AUD",n.CURRENCY_BDT="CURRENCY_BDT",n.CURRENCY_BGN="CURRENCY_BGN",n.CURRENCY_BOB="CURRENCY_BOB",n.CURRENCY_BRL="CURRENCY_BRL",n.CURRENCY_CAD="CURRENCY_CAD",n.CURRENCY_CDF="CURRENCY_CDF",n.CURRENCY_CHF="CURRENCY_CHF",n.CURRENCY_CLP="CURRENCY_CLP",n.CURRENCY_CNY="CURRENCY_CNY",n.CURRENCY_COP="CURRENCY_COP",n.CURRENCY_CRC="CURRENCY_CRC",n.CURRENCY_CZK="CURRENCY_CZK",n.CURRENCY_DKK="CURRENCY_DKK",n.CURRENCY_DOP="CURRENCY_DOP",n.CURRENCY_EGP="CURRENCY_EGP",n.CURRENCY_ETB="CURRENCY_ETB",n.CURRENCY_EUR="CURRENCY_EUR",n.CURRENCY_GBP="CURRENCY_GBP",n.CURRENCY_HKD="CURRENCY_HKD",n.CURRENCY_HRK="CURRENCY_HRK",n.CURRENCY_HUF="CURRENCY_HUF",n.CURRENCY_IDR="CURRENCY_IDR",n.CURRENCY_ILS="CURRENCY_ILS",n.CURRENCY_INR="CURRENCY_INR",n.CURRENCY_IRR="CURRENCY_IRR",n.CURRENCY_ISK="CURRENCY_ISK",n.CURRENCY_JMD="CURRENCY_JMD",n.CURRENCY_JPY="CURRENCY_JPY",n.CURRENCY_KRW="CURRENCY_KRW",n.CURRENCY_LKR="CURRENCY_LKR",n.CURRENCY_LTL="CURRENCY_LTL",n.CURRENCY_MNT="CURRENCY_MNT",n.CURRENCY_MVR="CURRENCY_MVR",n.CURRENCY_MXN="CURRENCY_MXN",n.CURRENCY_MYR="CURRENCY_MYR",n.CURRENCY_NOK="CURRENCY_NOK",n.CURRENCY_NZD="CURRENCY_NZD",n.CURRENCY_PAB="CURRENCY_PAB",n.CURRENCY_PEN="CURRENCY_PEN",n.CURRENCY_PHP="CURRENCY_PHP",n.CURRENCY_PKR="CURRENCY_PKR",n.CURRENCY_PLN="CURRENCY_PLN",n.CURRENCY_RON="CURRENCY_RON",n.CURRENCY_RSD="CURRENCY_RSD",n.CURRENCY_RUB="CURRENCY_RUB",n.CURRENCY_SAR="CURRENCY_SAR",n.CURRENCY_SEK="CURRENCY_SEK",n.CURRENCY_SGD="CURRENCY_SGD",n.CURRENCY_THB="CURRENCY_THB",n.CURRENCY_TRY="CURRENCY_TRY",n.CURRENCY_TWD="CURRENCY_TWD",n.CURRENCY_TZS="CURRENCY_TZS",n.CURRENCY_UAH="CURRENCY_UAH",n.CURRENCY_USD="CURRENCY_USD",n.CURRENCY_UYU="CURRENCY_UYU",n.CURRENCY_VEF="CURRENCY_VEF",n.CURRENCY_VND="CURRENCY_VND",n.CURRENCY_YER="CURRENCY_YER",n.CURRENCY_ZAR="CURRENCY_ZAR",(E=R.TableType||(R.TableType={})).DEFAULT="DEFAULT",E.COMPARISON="COMPARISON",E.SUMMARY="SUMMARY",(r=R.ConfigDataElementType||(R.ConfigDataElementType={})).METRIC="METRIC",r.DIMENSION="DIMENSION",r.MAX_RESULTS="MAX_RESULTS",(o=R.ConfigStyleElementType||(R.ConfigStyleElementType={})).TEXTINPUT="TEXTINPUT",o.SELECT_SINGLE="SELECT_SINGLE",o.CHECKBOX="CHECKBOX",o.FONT_COLOR="FONT_COLOR",o.FONT_SIZE="FONT_SIZE",o.FONT_FAMILY="FONT_FAMILY",o.FILL_COLOR="FILL_COLOR",o.BORDER_COLOR="BORDER_COLOR",o.AXIS_COLOR="AXIS_COLOR",o.GRID_COLOR="GRID_COLOR",o.OPACITY="OPACITY",o.LINE_WEIGHT="LINE_WEIGHT",o.LINE_STYLE="LINE_STYLE",o.BORDER_RADIUS="BORDER_RADIUS",o.INTERVAL="INTERVAL",o.SELECT_RADIO="SELECT_RADIO",(R.DSInteractionType||(R.DSInteractionType={})).FILTER="FILTER",(N=R.ToDSMessageType||(R.ToDSMessageType={})).VIZ_READY="vizReady",N.INTERACTION="vizAction",(R.InteractionType||(R.InteractionType={})).FILTER="FILTER"}},n.c=t,n.d=function(e,R,C){n.o(e,R)||Object.defineProperty(e,R,{enumerable:!0,get:C})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(R,e){if(1&e&&(R=n(R)),8&e)return R;if(4&e&&"object"==typeof R&&R&&R.__esModule)return R;var C=Object.create(null);if(n.r(C),Object.defineProperty(C,"default",{enumerable:!0,value:R}),2&e&&"string"!=typeof R)for(var t in R)n.d(C,t,function(e){return R[e]}.bind(null,t));return C},n.n=function(e){var R=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(R,"a",R),R},n.o=function(e,R){return Object.prototype.hasOwnProperty.call(e,R)},n.p="",n(n.s="./src/index.ts");function n(e){if(t[e])return t[e].exports;var R=t[e]={i:e,l:!1,exports:{}};return C[e].call(R.exports,R,R.exports,n),R.l=!0,R.exports}var C,t});
;
(()=>{var Xn={value:()=>{}};function ze(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new mt(r)}function mt(t){this._=t}function Pn(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}mt.prototype=ze.prototype={constructor:mt,on:function(t,e){var r=this._,n=Pn(t+"",r),i,o=-1,a=n.length;if(arguments.length<2){for(;++o<a;)if((i=(t=n[o]).type)&&(i=Ln(r[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(i=(t=n[o]).type)r[i]=Ce(r[i],t.name,e);else if(e==null)for(i in r)r[i]=Ce(r[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new mt(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,o;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],n=0,i=o.length;n<i;++n)o[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],i=0,o=n.length;i<o;++i)n[i].value.apply(e,r)}};function Ln(t,e){for(var r=0,n=t.length,i;r<n;++r)if((i=t[r]).name===e)return i.value}function Ce(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=Xn,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var Wt=ze;var dt="http://www.w3.org/1999/xhtml",Ut={svg:"http://www.w3.org/2000/svg",xhtml:dt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function I(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),Ut.hasOwnProperty(e)?{space:Ut[e],local:t}:t}function qn(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===dt&&e.documentElement.namespaceURI===dt?e.createElement(t):e.createElementNS(r,t)}}function Vn(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function xt(t){var e=I(t);return(e.local?Vn:qn)(e)}function Yn(){}function P(t){return t==null?Yn:function(){return this.querySelector(t)}}function Ie(t){typeof t!="function"&&(t=P(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var o=e[i],a=o.length,u=n[i]=new Array(a),l,s,f=0;f<a;++f)(l=o[f])&&(s=t.call(l,l.__data__,f,o))&&("__data__"in l&&(s.__data__=l.__data__),u[f]=s);return new _(n,this._parents)}function Zt(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Fn(){return[]}function j(t){return t==null?Fn:function(){return this.querySelectorAll(t)}}function Kn(t){return function(){return Zt(t.apply(this,arguments))}}function Me(t){typeof t=="function"?t=Kn(t):t=j(t);for(var e=this._groups,r=e.length,n=[],i=[],o=0;o<r;++o)for(var a=e[o],u=a.length,l,s=0;s<u;++s)(l=a[s])&&(n.push(t.call(l,l.__data__,s,a)),i.push(l));return new _(n,i)}function tt(t){return function(){return this.matches(t)}}function gt(t){return function(e){return e.matches(t)}}var Gn=Array.prototype.find;function Wn(t){return function(){return Gn.call(this.children,t)}}function Un(){return this.firstElementChild}function Oe(t){return this.select(t==null?Un:Wn(typeof t=="function"?t:gt(t)))}var Zn=Array.prototype.filter;function Qn(){return Array.from(this.children)}function Jn(t){return function(){return Zn.call(this.children,t)}}function Re(t){return this.selectAll(t==null?Qn:Jn(typeof t=="function"?t:gt(t)))}function Be(t){typeof t!="function"&&(t=tt(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var o=e[i],a=o.length,u=n[i]=[],l,s=0;s<a;++s)(l=o[s])&&t.call(l,l.__data__,s,o)&&u.push(l);return new _(n,this._parents)}function yt(t){return new Array(t.length)}function De(){return new _(this._enter||this._groups.map(yt),this._parents)}function et(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}et.prototype={constructor:et,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function He(t){return function(){return t}}function jn(t,e,r,n,i,o){for(var a=0,u,l=e.length,s=o.length;a<s;++a)(u=e[a])?(u.__data__=o[a],n[a]=u):r[a]=new et(t,o[a]);for(;a<l;++a)(u=e[a])&&(i[a]=u)}function ti(t,e,r,n,i,o,a){var u,l,s=new Map,f=e.length,h=o.length,c=new Array(f),p;for(u=0;u<f;++u)(l=e[u])&&(c[u]=p=a.call(l,l.__data__,u,e)+"",s.has(p)?i[u]=l:s.set(p,l));for(u=0;u<h;++u)p=a.call(t,o[u],u,o)+"",(l=s.get(p))?(n[u]=l,l.__data__=o[u],s.delete(p)):r[u]=new et(t,o[u]);for(u=0;u<f;++u)(l=e[u])&&s.get(c[u])===l&&(i[u]=l)}function ei(t){return t.__data__}function Xe(t,e){if(!arguments.length)return Array.from(this,ei);var r=e?ti:jn,n=this._parents,i=this._groups;typeof t!="function"&&(t=He(t));for(var o=i.length,a=new Array(o),u=new Array(o),l=new Array(o),s=0;s<o;++s){var f=n[s],h=i[s],c=h.length,p=ri(t.call(f,f&&f.__data__,s,n)),m=p.length,x=u[s]=new Array(m),w=a[s]=new Array(m),N=l[s]=new Array(c);r(f,h,x,w,N,p,e);for(var g=0,$=0,y,X;g<m;++g)if(y=x[g]){for(g>=$&&($=g+1);!(X=w[$])&&++$<m;);y._next=X||null}}return a=new _(a,n),a._enter=u,a._exit=l,a}function ri(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Pe(){return new _(this._exit||this._groups.map(yt),this._parents)}function Le(t,e,r){var n=this.enter(),i=this,o=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),r==null?o.remove():r(o),n&&i?n.merge(i).order():i}function qe(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,i=r.length,o=n.length,a=Math.min(i,o),u=new Array(i),l=0;l<a;++l)for(var s=r[l],f=n[l],h=s.length,c=u[l]=new Array(h),p,m=0;m<h;++m)(p=s[m]||f[m])&&(c[m]=p);for(;l<i;++l)u[l]=r[l];return new _(u,this._parents)}function Ve(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n=t[e],i=n.length-1,o=n[i],a;--i>=0;)(a=n[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function Ye(t){t||(t=ni);function e(h,c){return h&&c?t(h.__data__,c.__data__):!h-!c}for(var r=this._groups,n=r.length,i=new Array(n),o=0;o<n;++o){for(var a=r[o],u=a.length,l=i[o]=new Array(u),s,f=0;f<u;++f)(s=a[f])&&(l[f]=s);l.sort(e)}return new _(i,this._parents).order()}function ni(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Fe(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Ke(){return Array.from(this)}function Ge(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,o=n.length;i<o;++i){var a=n[i];if(a)return a}return null}function We(){let t=0;for(let e of this)++t;return t}function Ue(){return!this.node()}function Ze(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i=e[r],o=0,a=i.length,u;o<a;++o)(u=i[o])&&t.call(u,u.__data__,o,i);return this}function ii(t){return function(){this.removeAttribute(t)}}function oi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ai(t,e){return function(){this.setAttribute(t,e)}}function si(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ui(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function li(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function Qe(t,e){var r=I(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((e==null?r.local?oi:ii:typeof e=="function"?r.local?li:ui:r.local?si:ai)(r,e))}function _t(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function fi(t){return function(){this.style.removeProperty(t)}}function ci(t,e,r){return function(){this.style.setProperty(t,e,r)}}function hi(t,e,r){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function Je(t,e,r){return arguments.length>1?this.each((e==null?fi:typeof e=="function"?hi:ci)(t,e,r==null?"":r)):R(this.node(),t)}function R(t,e){return t.style.getPropertyValue(e)||_t(t).getComputedStyle(t,null).getPropertyValue(e)}function pi(t){return function(){delete this[t]}}function mi(t,e){return function(){this[t]=e}}function di(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function je(t,e){return arguments.length>1?this.each((e==null?pi:typeof e=="function"?di:mi)(t,e)):this.node()[t]}function tr(t){return t.trim().split(/^|\s+/)}function Qt(t){return t.classList||new er(t)}function er(t){this._node=t,this._names=tr(t.getAttribute("class")||"")}er.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function rr(t,e){for(var r=Qt(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function nr(t,e){for(var r=Qt(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function xi(t){return function(){rr(this,t)}}function gi(t){return function(){nr(this,t)}}function yi(t,e){return function(){(e.apply(this,arguments)?rr:nr)(this,t)}}function ir(t,e){var r=tr(t+"");if(arguments.length<2){for(var n=Qt(this.node()),i=-1,o=r.length;++i<o;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof e=="function"?yi:e?xi:gi)(r,e))}function _i(){this.textContent=""}function wi(t){return function(){this.textContent=t}}function vi(t){return function(){var e=t.apply(this,arguments);this.textContent=e==null?"":e}}function or(t){return arguments.length?this.each(t==null?_i:(typeof t=="function"?vi:wi)(t)):this.node().textContent}function bi(){this.innerHTML=""}function ki(t){return function(){this.innerHTML=t}}function Ai(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e==null?"":e}}function ar(t){return arguments.length?this.each(t==null?bi:(typeof t=="function"?Ai:ki)(t)):this.node().innerHTML}function Ei(){this.nextSibling&&this.parentNode.appendChild(this)}function sr(){return this.each(Ei)}function Ni(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ur(){return this.each(Ni)}function lr(t){var e=typeof t=="function"?t:xt(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function $i(){return null}function fr(t,e){var r=typeof t=="function"?t:xt(t),n=e==null?$i:typeof e=="function"?e:P(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function Si(){var t=this.parentNode;t&&t.removeChild(this)}function cr(){return this.each(Si)}function Ti(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ci(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function hr(t){return this.select(t?Ci:Ti)}function pr(t){return arguments.length?this.property("__data__",t):this.node().__data__}function zi(t){return function(e){t.call(this,e,this.__data__)}}function Ii(t){return t.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{type:e,name:r}})}function Mi(t){return function(){var e=this.__on;if(e){for(var r=0,n=-1,i=e.length,o;r<i;++r)o=e[r],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++n]=o;++n?e.length=n:delete this.__on}}}function Oi(t,e,r){return function(){var n=this.__on,i,o=zi(e);if(n){for(var a=0,u=n.length;a<u;++a)if((i=n[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=r),i.value=e;return}}this.addEventListener(t.type,o,r),i={type:t.type,name:t.name,value:e,listener:o,options:r},n?n.push(i):this.__on=[i]}}function mr(t,e,r){var n=Ii(t+""),i,o=n.length,a;if(arguments.length<2){var u=this.node().__on;if(u){for(var l=0,s=u.length,f;l<s;++l)for(i=0,f=u[l];i<o;++i)if((a=n[i]).type===f.type&&a.name===f.name)return f.value}return}for(u=e?Oi:Mi,i=0;i<o;++i)this.each(u(n[i],e,r));return this}function dr(t,e,r){var n=_t(t),i=n.CustomEvent;typeof i=="function"?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Ri(t,e){return function(){return dr(this,t,e)}}function Bi(t,e){return function(){return dr(this,t,e.apply(this,arguments))}}function xr(t,e){return this.each((typeof e=="function"?Bi:Ri)(t,e))}function*gr(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,o=n.length,a;i<o;++i)(a=n[i])&&(yield a)}var Jt=[null];function _(t,e){this._groups=t,this._parents=e}function yr(){return new _([[document.documentElement]],Jt)}function Di(){return this}_.prototype=yr.prototype={constructor:_,select:Ie,selectAll:Me,selectChild:Oe,selectChildren:Re,filter:Be,data:Xe,enter:De,exit:Pe,join:Le,merge:qe,selection:Di,order:Ve,sort:Ye,call:Fe,nodes:Ke,node:Ge,size:We,empty:Ue,each:Ze,attr:Qe,style:Je,property:je,classed:ir,text:or,html:ar,raise:sr,lower:ur,append:lr,insert:fr,remove:cr,clone:hr,datum:pr,on:mr,dispatch:xr,[Symbol.iterator]:gr};var M=yr;function jt(t){return typeof t=="string"?new _([[document.querySelector(t)]],[document.documentElement]):new _([[t]],Jt)}function wt(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function te(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function it(){}var rt=.7,kt=1/rt,G="\\s*([+-]?\\d+)\\s*",nt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",z="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Hi=/^#([0-9a-f]{3,8})$/,Xi=new RegExp(`^rgb\\(${G},${G},${G}\\)$`),Pi=new RegExp(`^rgb\\(${z},${z},${z}\\)$`),Li=new RegExp(`^rgba\\(${G},${G},${G},${nt}\\)$`),qi=new RegExp(`^rgba\\(${z},${z},${z},${nt}\\)$`),Vi=new RegExp(`^hsl\\(${nt},${z},${z}\\)$`),Yi=new RegExp(`^hsla\\(${nt},${z},${z},${nt}\\)$`),_r={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};wt(it,B,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:wr,formatHex:wr,formatHex8:Fi,formatHsl:Ki,formatRgb:vr,toString:vr});function wr(){return this.rgb().formatHex()}function Fi(){return this.rgb().formatHex8()}function Ki(){return $r(this).formatHsl()}function vr(){return this.rgb().formatRgb()}function B(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Hi.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?br(e):r===3?new E(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?vt(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?vt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Xi.exec(t))?new E(e[1],e[2],e[3],1):(e=Pi.exec(t))?new E(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Li.exec(t))?vt(e[1],e[2],e[3],e[4]):(e=qi.exec(t))?vt(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Vi.exec(t))?Er(e[1],e[2]/100,e[3]/100,1):(e=Yi.exec(t))?Er(e[1],e[2]/100,e[3]/100,e[4]):_r.hasOwnProperty(t)?br(_r[t]):t==="transparent"?new E(NaN,NaN,NaN,0):null}function br(t){return new E(t>>16&255,t>>8&255,t&255,1)}function vt(t,e,r,n){return n<=0&&(t=e=r=NaN),new E(t,e,r,n)}function Gi(t){return t instanceof it||(t=B(t)),t?(t=t.rgb(),new E(t.r,t.g,t.b,t.opacity)):new E}function W(t,e,r,n){return arguments.length===1?Gi(t):new E(t,e,r,n==null?1:n)}function E(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}wt(E,W,te(it,{brighter(t){return t=t==null?kt:Math.pow(kt,t),new E(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?rt:Math.pow(rt,t),new E(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new E(q(this.r),q(this.g),q(this.b),At(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kr,formatHex:kr,formatHex8:Wi,formatRgb:Ar,toString:Ar}));function kr(){return`#${L(this.r)}${L(this.g)}${L(this.b)}`}function Wi(){return`#${L(this.r)}${L(this.g)}${L(this.b)}${L((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ar(){let t=At(this.opacity);return`${t===1?"rgb(":"rgba("}${q(this.r)}, ${q(this.g)}, ${q(this.b)}${t===1?")":`, ${t})`}`}function At(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function q(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function L(t){return t=q(t),(t<16?"0":"")+t.toString(16)}function Er(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new C(t,e,r,n)}function $r(t){if(t instanceof C)return new C(t.h,t.s,t.l,t.opacity);if(t instanceof it||(t=B(t)),!t)return new C;if(t instanceof C)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),o=Math.max(e,r,n),a=NaN,u=o-i,l=(o+i)/2;return u?(e===o?a=(r-n)/u+(r<n)*6:r===o?a=(n-e)/u+2:a=(e-r)/u+4,u/=l<.5?o+i:2-o-i,a*=60):u=l>0&&l<1?0:a,new C(a,u,l,t.opacity)}function Sr(t,e,r,n){return arguments.length===1?$r(t):new C(t,e,r,n==null?1:n)}function C(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}wt(C,Sr,te(it,{brighter(t){return t=t==null?kt:Math.pow(kt,t),new C(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?rt:Math.pow(rt,t),new C(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new E(ee(t>=240?t-240:t+120,i,n),ee(t,i,n),ee(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new C(Nr(this.h),bt(this.s),bt(this.l),At(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=At(this.opacity);return`${t===1?"hsl(":"hsla("}${Nr(this.h)}, ${bt(this.s)*100}%, ${bt(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Nr(t){return t=(t||0)%360,t<0?t+360:t}function bt(t){return Math.max(0,Math.min(1,t||0))}function ee(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}function re(t,e,r,n,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*r+(1+3*t+3*o-3*a)*n+a*i)/6}function Tr(t){var e=t.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,e-1):Math.floor(r*e),i=t[n],o=t[n+1],a=n>0?t[n-1]:2*i-o,u=n<e-1?t[n+2]:2*o-i;return re((r-n/e)*e,a,i,o,u)}}function Cr(t){var e=t.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*e),i=t[(n+e-1)%e],o=t[n%e],a=t[(n+1)%e],u=t[(n+2)%e];return re((r-n/e)*e,i,o,a,u)}}var ne=t=>()=>t;function Ui(t,e){return function(r){return t+r*e}}function Zi(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function zr(t){return(t=+t)==1?Et:function(e,r){return r-e?Zi(e,r,t):ne(isNaN(e)?r:e)}}function Et(t,e){var r=e-t;return r?Ui(t,r):ne(isNaN(t)?e:t)}var Nt=(function t(e){var r=zr(e);function n(i,o){var a=r((i=W(i)).r,(o=W(o)).r),u=r(i.g,o.g),l=r(i.b,o.b),s=Et(i.opacity,o.opacity);return function(f){return i.r=a(f),i.g=u(f),i.b=l(f),i.opacity=s(f),i+""}}return n.gamma=t,n})(1);function Ir(t){return function(e){var r=e.length,n=new Array(r),i=new Array(r),o=new Array(r),a,u;for(a=0;a<r;++a)u=W(e[a]),n[a]=u.r||0,i[a]=u.g||0,o[a]=u.b||0;return n=t(n),i=t(i),o=t(o),u.opacity=1,function(l){return u.r=n(l),u.g=i(l),u.b=o(l),u+""}}}var Qi=Ir(Tr),Ji=Ir(Cr);function S(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}var oe=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ie=new RegExp(oe.source,"g");function ji(t){return function(){return t}}function to(t){return function(e){return t(e)+""}}function ae(t,e){var r=oe.lastIndex=ie.lastIndex=0,n,i,o,a=-1,u=[],l=[];for(t=t+"",e=e+"";(n=oe.exec(t))&&(i=ie.exec(e));)(o=i.index)>r&&(o=e.slice(r,o),u[a]?u[a]+=o:u[++a]=o),(n=n[0])===(i=i[0])?u[a]?u[a]+=i:u[++a]=i:(u[++a]=null,l.push({i:a,x:S(n,i)})),r=ie.lastIndex;return r<e.length&&(o=e.slice(r),u[a]?u[a]+=o:u[++a]=o),u.length<2?l[0]?to(l[0].x):ji(e):(e=l.length,function(s){for(var f=0,h;f<e;++f)u[(h=l[f]).i]=h.x(s);return u.join("")})}var Mr=180/Math.PI,$t={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function se(t,e,r,n,i,o){var a,u,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*r+e*n)&&(r-=t*l,n-=e*l),(u=Math.sqrt(r*r+n*n))&&(r/=u,n/=u,l/=u),t*n<e*r&&(t=-t,e=-e,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Mr,skewX:Math.atan(l)*Mr,scaleX:a,scaleY:u}}var St;function Or(t){let e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?$t:se(e.a,e.b,e.c,e.d,e.e,e.f)}function Rr(t){return t==null?$t:(St||(St=document.createElementNS("http://www.w3.org/2000/svg","g")),St.setAttribute("transform",t),(t=St.transform.baseVal.consolidate())?(t=t.matrix,se(t.a,t.b,t.c,t.d,t.e,t.f)):$t)}function Br(t,e,r,n){function i(s){return s.length?s.pop()+" ":""}function o(s,f,h,c,p,m){if(s!==h||f!==c){var x=p.push("translate(",null,e,null,r);m.push({i:x-4,x:S(s,h)},{i:x-2,x:S(f,c)})}else(h||c)&&p.push("translate("+h+e+c+r)}function a(s,f,h,c){s!==f?(s-f>180?f+=360:f-s>180&&(s+=360),c.push({i:h.push(i(h)+"rotate(",null,n)-2,x:S(s,f)})):f&&h.push(i(h)+"rotate("+f+n)}function u(s,f,h,c){s!==f?c.push({i:h.push(i(h)+"skewX(",null,n)-2,x:S(s,f)}):f&&h.push(i(h)+"skewX("+f+n)}function l(s,f,h,c,p,m){if(s!==h||f!==c){var x=p.push(i(p)+"scale(",null,",",null,")");m.push({i:x-4,x:S(s,h)},{i:x-2,x:S(f,c)})}else(h!==1||c!==1)&&p.push(i(p)+"scale("+h+","+c+")")}return function(s,f){var h=[],c=[];return s=t(s),f=t(f),o(s.translateX,s.translateY,f.translateX,f.translateY,h,c),a(s.rotate,f.rotate,h,c),u(s.skewX,f.skewX,h,c),l(s.scaleX,s.scaleY,f.scaleX,f.scaleY,h,c),s=f=null,function(p){for(var m=-1,x=c.length,w;++m<x;)h[(w=c[m]).i]=w.x(p);return h.join("")}}}var ue=Br(Or,"px, ","px)","deg)"),le=Br(Rr,", ",")",")");var U=0,at=0,ot=0,Hr=1e3,Tt,st,Ct=0,V=0,zt=0,ut=typeof performance=="object"&&performance.now?performance:Date,Xr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ft(){return V||(Xr(eo),V=ut.now()+zt)}function eo(){V=0}function lt(){this._call=this._time=this._next=null}lt.prototype=It.prototype={constructor:lt,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?ft():+r)+(e==null?0:+e),!this._next&&st!==this&&(st?st._next=this:Tt=this,st=this),this._call=t,this._time=r,fe()},stop:function(){this._call&&(this._call=null,this._time=1/0,fe())}};function It(t,e,r){var n=new lt;return n.restart(t,e,r),n}function Pr(){ft(),++U;for(var t=Tt,e;t;)(e=V-t._time)>=0&&t._call.call(void 0,e),t=t._next;--U}function Dr(){V=(Ct=ut.now())+zt,U=at=0;try{Pr()}finally{U=0,no(),V=0}}function ro(){var t=ut.now(),e=t-Ct;e>Hr&&(zt-=e,Ct=t)}function no(){for(var t,e=Tt,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:Tt=r);st=t,fe(n)}function fe(t){if(!U){at&&(at=clearTimeout(at));var e=t-V;e>24?(t<1/0&&(at=setTimeout(Dr,t-ut.now()-zt)),ot&&(ot=clearInterval(ot))):(ot||(Ct=ut.now(),ot=setInterval(ro,Hr)),U=1,Xr(Dr))}}function Mt(t,e,r){var n=new lt;return e=e==null?0:+e,n.restart(i=>{n.stop(),t(i+e)},e,r),n}var io=Wt("start","end","cancel","interrupt"),oo=[],Vr=0,Lr=1,Rt=2,Ot=3,qr=4,Bt=5,ct=6;function D(t,e,r,n,i,o){var a=t.__transition;if(!a)t.__transition={};else if(r in a)return;ao(t,r,{name:e,index:n,group:i,on:io,tween:oo,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Vr})}function ht(t,e){var r=b(t,e);if(r.state>Vr)throw new Error("too late; already scheduled");return r}function k(t,e){var r=b(t,e);if(r.state>Ot)throw new Error("too late; already running");return r}function b(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function ao(t,e,r){var n=t.__transition,i;n[e]=r,r.timer=It(o,0,r.time);function o(s){r.state=Lr,r.timer.restart(a,r.delay,r.time),r.delay<=s&&a(s-r.delay)}function a(s){var f,h,c,p;if(r.state!==Lr)return l();for(f in n)if(p=n[f],p.name===r.name){if(p.state===Ot)return Mt(a);p.state===qr?(p.state=ct,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete n[f]):+f<e&&(p.state=ct,p.timer.stop(),p.on.call("cancel",t,t.__data__,p.index,p.group),delete n[f])}if(Mt(function(){r.state===Ot&&(r.state=qr,r.timer.restart(u,r.delay,r.time),u(s))}),r.state=Rt,r.on.call("start",t,t.__data__,r.index,r.group),r.state===Rt){for(r.state=Ot,i=new Array(c=r.tween.length),f=0,h=-1;f<c;++f)(p=r.tween[f].value.call(t,t.__data__,r.index,r.group))&&(i[++h]=p);i.length=h+1}}function u(s){for(var f=s<r.duration?r.ease.call(null,s/r.duration):(r.timer.restart(l),r.state=Bt,1),h=-1,c=i.length;++h<c;)i[h].call(t,f);r.state===Bt&&(r.on.call("end",t,t.__data__,r.index,r.group),l())}function l(){r.state=ct,r.timer.stop(),delete n[e];for(var s in n)return;delete t.__transition}}function Dt(t,e){var r=t.__transition,n,i,o=!0,a;if(r){e=e==null?null:e+"";for(a in r){if((n=r[a]).name!==e){o=!1;continue}i=n.state>Rt&&n.state<Bt,n.state=ct,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[a]}o&&delete t.__transition}}function Yr(t){return this.each(function(){Dt(this,t)})}function so(t,e){var r,n;return function(){var i=k(this,t),o=i.tween;if(o!==r){n=r=o;for(var a=0,u=n.length;a<u;++a)if(n[a].name===e){n=n.slice(),n.splice(a,1);break}}i.tween=n}}function uo(t,e,r){var n,i;if(typeof r!="function")throw new Error;return function(){var o=k(this,t),a=o.tween;if(a!==n){i=(n=a).slice();for(var u={name:e,value:r},l=0,s=i.length;l<s;++l)if(i[l].name===e){i[l]=u;break}l===s&&i.push(u)}o.tween=i}}function Fr(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n=b(this.node(),r).tween,i=0,o=n.length,a;i<o;++i)if((a=n[i]).name===t)return a.value;return null}return this.each((e==null?so:uo)(r,t,e))}function Z(t,e,r){var n=t._id;return t.each(function(){var i=k(this,n);(i.value||(i.value={}))[e]=r.apply(this,arguments)}),function(i){return b(i,n).value[e]}}function Ht(t,e){var r;return(typeof e=="number"?S:e instanceof B?Nt:(r=B(e))?(e=r,Nt):ae)(t,e)}function lo(t){return function(){this.removeAttribute(t)}}function fo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function co(t,e,r){var n,i=r+"",o;return function(){var a=this.getAttribute(t);return a===i?null:a===n?o:o=e(n=a,r)}}function ho(t,e,r){var n,i=r+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===n?o:o=e(n=a,r)}}function po(t,e,r){var n,i,o;return function(){var a,u=r(this),l;return u==null?void this.removeAttribute(t):(a=this.getAttribute(t),l=u+"",a===l?null:a===n&&l===i?o:(i=l,o=e(n=a,u)))}}function mo(t,e,r){var n,i,o;return function(){var a,u=r(this),l;return u==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),l=u+"",a===l?null:a===n&&l===i?o:(i=l,o=e(n=a,u)))}}function Kr(t,e){var r=I(t),n=r==="transform"?le:Ht;return this.attrTween(t,typeof e=="function"?(r.local?mo:po)(r,n,Z(this,"attr."+t,e)):e==null?(r.local?fo:lo)(r):(r.local?ho:co)(r,n,e))}function xo(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function go(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function yo(t,e){var r,n;function i(){var o=e.apply(this,arguments);return o!==n&&(r=(n=o)&&go(t,o)),r}return i._value=e,i}function _o(t,e){var r,n;function i(){var o=e.apply(this,arguments);return o!==n&&(r=(n=o)&&xo(t,o)),r}return i._value=e,i}function Gr(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var n=I(t);return this.tween(r,(n.local?yo:_o)(n,e))}function wo(t,e){return function(){ht(this,t).delay=+e.apply(this,arguments)}}function vo(t,e){return e=+e,function(){ht(this,t).delay=e}}function Wr(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?wo:vo)(e,t)):b(this.node(),e).delay}function bo(t,e){return function(){k(this,t).duration=+e.apply(this,arguments)}}function ko(t,e){return e=+e,function(){k(this,t).duration=e}}function Ur(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?bo:ko)(e,t)):b(this.node(),e).duration}function Ao(t,e){if(typeof e!="function")throw new Error;return function(){k(this,t).ease=e}}function Zr(t){var e=this._id;return arguments.length?this.each(Ao(e,t)):b(this.node(),e).ease}function Eo(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;k(this,t).ease=r}}function Qr(t){if(typeof t!="function")throw new Error;return this.each(Eo(this._id,t))}function Jr(t){typeof t!="function"&&(t=tt(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var o=e[i],a=o.length,u=n[i]=[],l,s=0;s<a;++s)(l=o[s])&&t.call(l,l.__data__,s,o)&&u.push(l);return new A(n,this._parents,this._name,this._id)}function jr(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,i=r.length,o=Math.min(n,i),a=new Array(n),u=0;u<o;++u)for(var l=e[u],s=r[u],f=l.length,h=a[u]=new Array(f),c,p=0;p<f;++p)(c=l[p]||s[p])&&(h[p]=c);for(;u<n;++u)a[u]=e[u];return new A(a,this._parents,this._name,this._id)}function No(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function $o(t,e,r){var n,i,o=No(e)?ht:k;return function(){var a=o(this,t),u=a.on;u!==n&&(i=(n=u).copy()).on(e,r),a.on=i}}function tn(t,e){var r=this._id;return arguments.length<2?b(this.node(),r).on.on(t):this.each($o(r,t,e))}function So(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function en(){return this.on("end.remove",So(this._id))}function rn(t){var e=this._name,r=this._id;typeof t!="function"&&(t=P(t));for(var n=this._groups,i=n.length,o=new Array(i),a=0;a<i;++a)for(var u=n[a],l=u.length,s=o[a]=new Array(l),f,h,c=0;c<l;++c)(f=u[c])&&(h=t.call(f,f.__data__,c,u))&&("__data__"in f&&(h.__data__=f.__data__),s[c]=h,D(s[c],e,r,c,s,b(f,r)));return new A(o,this._parents,e,r)}function nn(t){var e=this._name,r=this._id;typeof t!="function"&&(t=j(t));for(var n=this._groups,i=n.length,o=[],a=[],u=0;u<i;++u)for(var l=n[u],s=l.length,f,h=0;h<s;++h)if(f=l[h]){for(var c=t.call(f,f.__data__,h,l),p,m=b(f,r),x=0,w=c.length;x<w;++x)(p=c[x])&&D(p,e,r,x,c,m);o.push(c),a.push(f)}return new A(o,a,e,r)}var To=M.prototype.constructor;function on(){return new To(this._groups,this._parents)}function Co(t,e){var r,n,i;return function(){var o=R(this,t),a=(this.style.removeProperty(t),R(this,t));return o===a?null:o===r&&a===n?i:i=e(r=o,n=a)}}function an(t){return function(){this.style.removeProperty(t)}}function zo(t,e,r){var n,i=r+"",o;return function(){var a=R(this,t);return a===i?null:a===n?o:o=e(n=a,r)}}function Io(t,e,r){var n,i,o;return function(){var a=R(this,t),u=r(this),l=u+"";return u==null&&(l=u=(this.style.removeProperty(t),R(this,t))),a===l?null:a===n&&l===i?o:(i=l,o=e(n=a,u))}}function Mo(t,e){var r,n,i,o="style."+e,a="end."+o,u;return function(){var l=k(this,t),s=l.on,f=l.value[o]==null?u||(u=an(e)):void 0;(s!==r||i!==f)&&(n=(r=s).copy()).on(a,i=f),l.on=n}}function sn(t,e,r){var n=(t+="")=="transform"?ue:Ht;return e==null?this.styleTween(t,Co(t,n)).on("end.style."+t,an(t)):typeof e=="function"?this.styleTween(t,Io(t,n,Z(this,"style."+t,e))).each(Mo(this._id,t)):this.styleTween(t,zo(t,n,e),r).on("end.style."+t,null)}function Oo(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function Ro(t,e,r){var n,i;function o(){var a=e.apply(this,arguments);return a!==i&&(n=(i=a)&&Oo(t,a,r)),n}return o._value=e,o}function un(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,Ro(t,e,r==null?"":r))}function Bo(t){return function(){this.textContent=t}}function Do(t){return function(){var e=t(this);this.textContent=e==null?"":e}}function ln(t){return this.tween("text",typeof t=="function"?Do(Z(this,"text",t)):Bo(t==null?"":t+""))}function Ho(t){return function(e){this.textContent=t.call(this,e)}}function Xo(t){var e,r;function n(){var i=t.apply(this,arguments);return i!==r&&(e=(r=i)&&Ho(i)),e}return n._value=t,n}function fn(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Xo(t))}function cn(){for(var t=this._name,e=this._id,r=Xt(),n=this._groups,i=n.length,o=0;o<i;++o)for(var a=n[o],u=a.length,l,s=0;s<u;++s)if(l=a[s]){var f=b(l,e);D(l,t,r,s,a,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new A(n,this._parents,t,r)}function hn(){var t,e,r=this,n=r._id,i=r.size();return new Promise(function(o,a){var u={value:a},l={value:function(){--i===0&&o()}};r.each(function(){var s=k(this,n),f=s.on;f!==t&&(e=(t=f).copy(),e._.cancel.push(u),e._.interrupt.push(u),e._.end.push(l)),s.on=e}),i===0&&o()})}var Po=0;function A(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function pn(t){return M().transition(t)}function Xt(){return++Po}var O=M.prototype;A.prototype=pn.prototype={constructor:A,select:rn,selectAll:nn,selectChild:O.selectChild,selectChildren:O.selectChildren,filter:Jr,merge:jr,selection:on,transition:cn,call:O.call,nodes:O.nodes,node:O.node,size:O.size,empty:O.empty,each:O.each,on:tn,attr:Kr,attrTween:Gr,style:sn,styleTween:un,text:ln,textTween:fn,remove:en,tween:Fr,delay:Wr,duration:Ur,ease:Zr,easeVarying:Qr,end:hn,[Symbol.iterator]:O[Symbol.iterator]};function Pt(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Lo={time:null,delay:0,duration:250,ease:Pt};function qo(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function mn(t){var e,r;t instanceof A?(e=t._id,t=t._name):(e=Xt(),(r=Lo).time=ft(),t=t==null?null:t+"");for(var n=this._groups,i=n.length,o=0;o<i;++o)for(var a=n[o],u=a.length,l,s=0;s<u;++s)(l=a[s])&&D(l,t,e,s,a,r||qo(l,e));return new A(n,this._parents,t,e)}M.prototype.interrupt=Yr;M.prototype.transition=mn;var{abs:ac,max:sc,min:uc}=Math;function dn(t){return[+t[0],+t[1]]}function Vo(t){return[dn(t[0]),dn(t[1])]}var lc={name:"x",handles:["w","e"].map(ce),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},fc={name:"y",handles:["n","s"].map(ce),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},cc={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(ce),input:function(t){return t==null?null:Vo(t)},output:function(t){return t}};function ce(t){return{type:t}}var he=Math.PI,pe=2*he,Y=1e-6,Yo=pe-Y;function xn(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function Fo(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return xn;let r=10**e;return function(n){this._+=n[0];for(let i=1,o=n.length;i<o;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}var F=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?xn:Fo(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,o,a){this._append`C${+e},${+r},${+n},${+i},${this._x1=+o},${this._y1=+a}`}arcTo(e,r,n,i,o){if(e=+e,r=+r,n=+n,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let a=this._x1,u=this._y1,l=n-e,s=i-r,f=a-e,h=u-r,c=f*f+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(c>Y)if(!(Math.abs(h*l-s*f)>Y)||!o)this._append`L${this._x1=e},${this._y1=r}`;else{let p=n-a,m=i-u,x=l*l+s*s,w=p*p+m*m,N=Math.sqrt(x),g=Math.sqrt(c),$=o*Math.tan((he-Math.acos((x+c-w)/(2*N*g)))/2),y=$/g,X=$/N;Math.abs(y-1)>Y&&this._append`L${e+y*f},${r+y*h}`,this._append`A${o},${o},0,0,${+(h*p>f*m)},${this._x1=e+X*l},${this._y1=r+X*s}`}}arc(e,r,n,i,o,a){if(e=+e,r=+r,n=+n,a=!!a,n<0)throw new Error(`negative radius: ${n}`);let u=n*Math.cos(i),l=n*Math.sin(i),s=e+u,f=r+l,h=1^a,c=a?i-o:o-i;this._x1===null?this._append`M${s},${f}`:(Math.abs(this._x1-s)>Y||Math.abs(this._y1-f)>Y)&&this._append`L${s},${f}`,n&&(c<0&&(c=c%pe+pe),c>Yo?this._append`A${n},${n},0,1,${h},${e-u},${r-l}A${n},${n},0,1,${h},${this._x1=s},${this._y1=f}`:c>Y&&this._append`A${n},${n},0,${+(c>=he)},${h},${this._x1=e+n*Math.cos(o)},${this._y1=r+n*Math.sin(o)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}};function gn(){return new F}gn.prototype=F.prototype;function Ko(t){var e=0,r=t.children,n=r&&r.length;if(!n)e=1;else for(;--n>=0;)e+=r[n].value;t.value=e}function yn(){return this.eachAfter(Ko)}function _n(t,e){let r=-1;for(let n of this)t.call(e,n,++r,this);return this}function wn(t,e){for(var r=this,n=[r],i,o,a=-1;r=n.pop();)if(t.call(e,r,++a,this),i=r.children)for(o=i.length-1;o>=0;--o)n.push(i[o]);return this}function vn(t,e){for(var r=this,n=[r],i=[],o,a,u,l=-1;r=n.pop();)if(i.push(r),o=r.children)for(a=0,u=o.length;a<u;++a)n.push(o[a]);for(;r=i.pop();)t.call(e,r,++l,this);return this}function bn(t,e){let r=-1;for(let n of this)if(t.call(e,n,++r,this))return n}function kn(t){return this.eachAfter(function(e){for(var r=+t(e.data)||0,n=e.children,i=n&&n.length;--i>=0;)r+=n[i].value;e.value=r})}function An(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function En(t){for(var e=this,r=Go(e,t),n=[e];e!==r;)e=e.parent,n.push(e);for(var i=n.length;t!==r;)n.splice(i,0,t),t=t.parent;return n}function Go(t,e){if(t===e)return t;var r=t.ancestors(),n=e.ancestors(),i=null;for(t=r.pop(),e=n.pop();t===e;)i=t,t=r.pop(),e=n.pop();return i}function Nn(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function $n(){return Array.from(this)}function Sn(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function Tn(){var t=this,e=[];return t.each(function(r){r!==t&&e.push({source:r.parent,target:r})}),e}function*Cn(){var t=this,e,r=[t],n,i,o;do for(e=r.reverse(),r=[];t=e.pop();)if(yield t,n=t.children)for(i=0,o=n.length;i<o;++i)r.push(n[i]);while(r.length)}function Q(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=Zo)):e===void 0&&(e=Uo);for(var r=new K(t),n,i=[r],o,a,u,l;n=i.pop();)if((a=e(n.data))&&(l=(a=Array.from(a)).length))for(n.children=a,u=l-1;u>=0;--u)i.push(o=a[u]=new K(a[u])),o.parent=n,o.depth=n.depth+1;return r.eachBefore(Jo)}function Wo(){return Q(this).eachBefore(Qo)}function Uo(t){return t.children}function Zo(t){return Array.isArray(t)?t[1]:null}function Qo(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function Jo(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function K(t){this.data=t,this.depth=this.height=0,this.parent=null}K.prototype=Q.prototype={constructor:K,count:yn,each:_n,eachAfter:vn,eachBefore:wn,find:bn,sum:kn,sort:An,path:En,ancestors:Nn,descendants:$n,leaves:Sn,links:Tn,copy:Wo,[Symbol.iterator]:Cn};function jo(t,e){return t.parent===e.parent?1:2}function me(t){var e=t.children;return e?e[0]:t.t}function de(t){var e=t.children;return e?e[e.length-1]:t.t}function ta(t,e,r){var n=r/(e.i-t.i);e.c-=n,e.s+=r,t.c+=n,e.z+=r,e.m+=r}function ea(t){for(var e=0,r=0,n=t.children,i=n.length,o;--i>=0;)o=n[i],o.z+=e,o.m+=e,e+=o.s+(r+=o.c)}function ra(t,e,r){return t.a.parent===e.parent?t.a:r}function Lt(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}Lt.prototype=Object.create(K.prototype);function na(t){for(var e=new Lt(t,0),r,n=[e],i,o,a,u;r=n.pop();)if(o=r._.children)for(r.children=new Array(u=o.length),a=u-1;a>=0;--a)n.push(i=r.children[a]=new Lt(o[a],a)),i.parent=r;return(e.parent=new Lt(null,0)).children=[e],e}function xe(){var t=jo,e=1,r=1,n=null;function i(s){var f=na(s);if(f.eachAfter(o),f.parent.m=-f.z,f.eachBefore(a),n)s.eachBefore(l);else{var h=s,c=s,p=s;s.eachBefore(function(g){g.x<h.x&&(h=g),g.x>c.x&&(c=g),g.depth>p.depth&&(p=g)});var m=h===c?1:t(h,c)/2,x=m-h.x,w=e/(c.x+m+x),N=r/(p.depth||1);s.eachBefore(function(g){g.x=(g.x+x)*w,g.y=g.depth*N})}return s}function o(s){var f=s.children,h=s.parent.children,c=s.i?h[s.i-1]:null;if(f){ea(s);var p=(f[0].z+f[f.length-1].z)/2;c?(s.z=c.z+t(s._,c._),s.m=s.z-p):s.z=p}else c&&(s.z=c.z+t(s._,c._));s.parent.A=u(s,c,s.parent.A||h[0])}function a(s){s._.x=s.z+s.parent.m,s.m+=s.parent.m}function u(s,f,h){if(f){for(var c=s,p=s,m=f,x=c.parent.children[0],w=c.m,N=p.m,g=m.m,$=x.m,y;m=de(m),c=me(c),m&&c;)x=me(x),p=de(p),p.a=s,y=m.z+g-c.z-w+t(m._,c._),y>0&&(ta(ra(m,s,h),s,y),w+=y,N+=y),g+=m.m,w+=c.m,$+=x.m,N+=p.m;m&&!de(p)&&(p.t=m,p.m+=g-N),c&&!me(x)&&(x.t=c,x.m+=w-$,h=s)}return h}function l(s){s.x*=e,s.y=s.depth*r}return i.separation=function(s){return arguments.length?(t=s,i):t},i.size=function(s){return arguments.length?(n=!1,e=+s[0],r=+s[1],i):n?null:[e,r]},i.nodeSize=function(s){return arguments.length?(n=!0,e=+s[0],r=+s[1],i):n?[e,r]:null},i}function ge(t){return function(){return t}}function zn(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{let n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new F(e)}var In=Array.prototype.slice;function Mn(t){return t[0]}function On(t){return t[1]}var ye=class{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}};function Rn(t){return new ye(t,!0)}function ia(t){return t.source}function oa(t){return t.target}function Bn(t){let e=ia,r=oa,n=Mn,i=On,o=null,a=null,u=zn(l);function l(){let s,f=In.call(arguments),h=e.apply(this,f),c=r.apply(this,f);if(o==null&&(a=t(s=u())),a.lineStart(),f[0]=h,a.point(+n.apply(this,f),+i.apply(this,f)),f[0]=c,a.point(+n.apply(this,f),+i.apply(this,f)),a.lineEnd(),s)return a=null,s+""||null}return l.source=function(s){return arguments.length?(e=s,l):e},l.target=function(s){return arguments.length?(r=s,l):r},l.x=function(s){return arguments.length?(n=typeof s=="function"?s:ge(+s),l):n},l.y=function(s){return arguments.length?(i=typeof s=="function"?s:ge(+s),l):i},l.context=function(s){return arguments.length?(s==null?o=a=null:a=t(o=s),l):o},l}function _e(){return Bn(Rn)}function H(t,e,r){this.k=t,this.x=e,this.y=r}H.prototype={constructor:H,scale:function(t){return t===1?this:new H(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new H(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var we=new H(1,0,0);ve.prototype=H.prototype;function ve(t){for(;!t.__zoom;)if(!(t=t.parentNode))return we;return t.__zoom}function sa(){let t=document.getElementById("viz");return t||(t=document.createElement("div"),t.id="viz",document.body.appendChild(t)),t}function ua(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function pt(t,e,r){try{let n=t.style&&t.style[e];return n==null||n===""?r:n}catch(n){return r}}function la(t,e,r){var a;let n={name:"root",children:[],value:0},i=(u,l)=>{u.children||(u.children=[]);let s=u.children.find(f=>f.name===l);return s||(s={name:l,children:[],value:0},u.children.push(s)),s};for(let u of t){let l=n;for(let f of e){let h=u[f]&&u[f].value!=null?String(u[f].value):"(null)";l=i(l,h)}let s=r?Number((a=u[r])==null?void 0:a.value)||0:1;l.value+=s}function o(u){if(!u.children||u.children.length===0)return u.value||0;let l=0;for(let s of u.children)l+=o(s);return u.value=l,l}return o(n),n}function fa(t){var ke,Ae,Ee,Ne,$e;let e=sa();ua(e);let r=window.dscc;if(!r){e.innerHTML="<div style='padding:12px'>dscc introuvable. V\xE9rifie que dscc.min.js est bien concat\xE9n\xE9 dans dist/viz.js.</div>";return}let n=r.getWidth(),i=r.getHeight(),o=((ke=t.fields)==null?void 0:ke.dims)||((Ae=t.fields)==null?void 0:Ae.dimensions)||[],a=((Ee=t.fields)==null?void 0:Ee.metric)||((Ne=t.fields)==null?void 0:Ne.metrics)||[],u=(Array.isArray(o)?o:[]).map(v=>v.id),l=Array.isArray(a)&&a.length>0?a[0].id:null,s=(($e=t.tables)==null?void 0:$e.DEFAULT)||[];if(!u||u.length<2){e.innerHTML="<div style='padding:12px'>Ajoute au moins <b>2 dimensions</b> pour construire l\u2019arbre.</div>";return}if(!s.length){e.innerHTML="<div style='padding:12px'>Aucune donn\xE9e.</div>";return}let f=!!pt(t,"showValue",!1),h=Number(pt(t,"fontSize",12)),c=Number(pt(t,"nodeRadius",4)),p=Number(pt(t,"indent",180)),m=Number(pt(t,"rowHeight",24)),x=la(s,u,l),w=jt(e).append("svg").attr("width",n).attr("height",i),N=w.append("g").attr("transform","translate(20,20)"),g=m,$=p,y=Q(x);y.x0=0,y.y0=0,y.descendants().forEach(v=>{v.id=v.id||Math.random().toString(16).slice(2),v._children=v.children,v.depth>1&&(v.children=null)});let X=xe().nodeSize([g,$]);function qt(v){return _e().x(J=>J.y).y(J=>J.x)(v)}function be(v){let J=y.descendants(),Dn=y.links();X(y);let Vt=y,Yt=y;y.eachBefore(d=>{d.x<Vt.x&&(Vt=d),d.x>Yt.x&&(Yt=d)});let Hn=Yt.x-Vt.x+40;w.attr("height",Math.max(i,Hn));let Ft=N.selectAll("g.node").data(J,d=>d.id),Kt=Ft.enter().append("g").attr("class","node").attr("transform",()=>`translate(${v.y0},${v.x0})`).on("click",(d,T)=>{T.children?(T._children=T.children,T.children=null):(T.children=T._children,T._children=null),be(T)});Kt.append("circle").attr("r",c).attr("fill",d=>d._children?"#555":"#999"),Kt.append("text").attr("dy","0.32em").attr("x",d=>d._children?-10:10).attr("text-anchor",d=>d._children?"end":"start").style("font-size",`${h}px`).text(d=>{var Te;if(d.depth===0)return"";let T=d.data.name;return f?`${T} (${(Te=d.value)!=null?Te:0})`:T});let Se=Kt.merge(Ft);Se.transition().duration(250).attr("transform",d=>`translate(${d.y},${d.x})`),Se.select("circle").attr("fill",d=>d._children?"#555":"#999"),Ft.exit().transition().duration(250).attr("transform",()=>`translate(${v.y},${v.x})`).remove();let Gt=N.selectAll("path.link").data(Dn,d=>d.target.id);Gt.enter().append("path").attr("class","link").attr("d",()=>{let d={x:v.x0,y:v.y0};return qt({source:d,target:d})}).merge(Gt).transition().duration(250).attr("d",qt),Gt.exit().transition().duration(250).attr("d",()=>{let d={x:v.x,y:v.y};return qt({source:d,target:d})}).remove(),y.eachBefore(d=>{d.x0=d.x,d.y0=d.y})}be(y)}(function(){let e=window.dscc;e&&e.subscribeToData(fa,{transform:e.objectTransform})})();})();

